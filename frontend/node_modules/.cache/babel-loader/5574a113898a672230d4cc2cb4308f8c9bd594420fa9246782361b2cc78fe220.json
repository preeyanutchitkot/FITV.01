{"ast":null,"code":"var _jsxFileName = \"C:\\\\Fit\\\\frontend\\\\src\\\\components\\\\KeypointOverlay.js\",\n  _s = $RefreshSig$();\nimport React, { useRef, useEffect, useState } from 'react';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst KeypointOverlay = ({\n  videoRef,\n  isPlaying,\n  onKeypointsDetected\n}) => {\n  _s();\n  const canvasRef = useRef(null);\n  const poseRef = useRef(null);\n  const [isInitialized, setIsInitialized] = useState(false);\n\n  // MediaPipe Pose connections (skeleton lines)\n  const POSE_CONNECTIONS = [[11, 12], [11, 13], [13, 15], [15, 17], [15, 19], [15, 21], [17, 19], [12, 14], [14, 16], [16, 18], [16, 20], [16, 22], [18, 20], [11, 23], [12, 24], [23, 24], [23, 25], [24, 26], [25, 27], [26, 28], [27, 29], [28, 30], [29, 31], [30, 32], [27, 31], [28, 32]];\n  useEffect(() => {\n    if (!(videoRef !== null && videoRef !== void 0 && videoRef.current) || !canvasRef.current) return;\n\n    // Initialize MediaPipe Pose\n    const pose = new Pose({\n      locateFile: file => {\n        return `https://cdn.jsdelivr.net/npm/@mediapipe/pose/${file}`;\n      }\n    });\n    pose.setOptions({\n      modelComplexity: 1,\n      smoothLandmarks: true,\n      enableSegmentation: false,\n      smoothSegmentation: true,\n      minDetectionConfidence: 0.5,\n      minTrackingConfidence: 0.5\n    });\n    pose.onResults(onResults);\n    poseRef.current = pose;\n    setIsInitialized(true);\n    return () => {\n      if (poseRef.current) {\n        poseRef.current.close();\n      }\n    };\n  }, [videoRef]);\n  useEffect(() => {\n    if (!isInitialized || !(videoRef !== null && videoRef !== void 0 && videoRef.current) || !canvasRef.current) return;\n    const video = videoRef.current;\n    const canvas = canvasRef.current;\n\n    // Match canvas size to video\n    const updateCanvasSize = () => {\n      canvas.width = video.videoWidth || video.clientWidth;\n      canvas.height = video.videoHeight || video.clientHeight;\n    };\n    const processFrame = async () => {\n      if (video.paused || video.ended || !isPlaying) return;\n      try {\n        updateCanvasSize();\n        await poseRef.current.send({\n          image: video\n        });\n      } catch (error) {\n        console.error('Pose detection error:', error);\n      }\n      if (isPlaying && !video.paused && !video.ended) {\n        requestAnimationFrame(processFrame);\n      }\n    };\n    if (isPlaying) {\n      if (video.readyState >= 2) {\n        processFrame();\n      } else {\n        video.addEventListener('loadeddata', processFrame, {\n          once: true\n        });\n      }\n    }\n\n    // Clean up canvas when not playing\n    if (!isPlaying) {\n      const ctx = canvas.getContext('2d');\n      ctx.clearRect(0, 0, canvas.width, canvas.height);\n    }\n  }, [isPlaying, isInitialized]);\n  const onResults = results => {\n    const canvas = canvasRef.current;\n    if (!canvas) return;\n    const ctx = canvas.getContext('2d');\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\n    if (results.poseLandmarks) {\n      // Draw skeleton connections\n      drawConnectors(ctx, results.poseLandmarks, POSE_CONNECTIONS, {\n        color: '#00FF00',\n        lineWidth: 2\n      });\n\n      // Draw keypoints\n      drawLandmarks(ctx, results.poseLandmarks, {\n        color: '#FF0000',\n        radius: 3\n      });\n\n      // Pass keypoints to parent component\n      if (onKeypointsDetected) {\n        onKeypointsDetected(results.poseLandmarks);\n      }\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"canvas\", {\n    ref: canvasRef,\n    style: {\n      position: 'absolute',\n      top: 0,\n      left: 0,\n      width: '100%',\n      height: '100%',\n      pointerEvents: 'none',\n      zIndex: 10\n    }\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 116,\n    columnNumber: 5\n  }, this);\n};\n_s(KeypointOverlay, \"Or+Zv5CsLDlzRM9F6x8IH98t+EE=\");\n_c = KeypointOverlay;\nexport default KeypointOverlay;\nvar _c;\n$RefreshReg$(_c, \"KeypointOverlay\");","map":{"version":3,"names":["React","useRef","useEffect","useState","jsxDEV","_jsxDEV","KeypointOverlay","videoRef","isPlaying","onKeypointsDetected","_s","canvasRef","poseRef","isInitialized","setIsInitialized","POSE_CONNECTIONS","current","pose","Pose","locateFile","file","setOptions","modelComplexity","smoothLandmarks","enableSegmentation","smoothSegmentation","minDetectionConfidence","minTrackingConfidence","onResults","close","video","canvas","updateCanvasSize","width","videoWidth","clientWidth","height","videoHeight","clientHeight","processFrame","paused","ended","send","image","error","console","requestAnimationFrame","readyState","addEventListener","once","ctx","getContext","clearRect","results","poseLandmarks","drawConnectors","color","lineWidth","drawLandmarks","radius","ref","style","position","top","left","pointerEvents","zIndex","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["C:/Fit/frontend/src/components/KeypointOverlay.js"],"sourcesContent":["import React, { useRef, useEffect, useState } from 'react';\r\n\r\nconst KeypointOverlay = ({ videoRef, isPlaying, onKeypointsDetected }) => {\r\n  const canvasRef = useRef(null);\r\n  const poseRef = useRef(null);\r\n  const [isInitialized, setIsInitialized] = useState(false);\r\n\r\n  // MediaPipe Pose connections (skeleton lines)\r\n  const POSE_CONNECTIONS = [\r\n    [11, 12], [11, 13], [13, 15], [15, 17], [15, 19], [15, 21], [17, 19],\r\n    [12, 14], [14, 16], [16, 18], [16, 20], [16, 22], [18, 20],\r\n    [11, 23], [12, 24], [23, 24], [23, 25], [24, 26], [25, 27], [26, 28],\r\n    [27, 29], [28, 30], [29, 31], [30, 32], [27, 31], [28, 32]\r\n  ];\r\n\r\n  useEffect(() => {\r\n    if (!videoRef?.current || !canvasRef.current) return;\r\n\r\n    // Initialize MediaPipe Pose\r\n    const pose = new Pose({\r\n      locateFile: (file) => {\r\n        return `https://cdn.jsdelivr.net/npm/@mediapipe/pose/${file}`;\r\n      }\r\n    });\r\n\r\n    pose.setOptions({\r\n      modelComplexity: 1,\r\n      smoothLandmarks: true,\r\n      enableSegmentation: false,\r\n      smoothSegmentation: true,\r\n      minDetectionConfidence: 0.5,\r\n      minTrackingConfidence: 0.5\r\n    });\r\n\r\n    pose.onResults(onResults);\r\n    poseRef.current = pose;\r\n    setIsInitialized(true);\r\n\r\n    return () => {\r\n      if (poseRef.current) {\r\n        poseRef.current.close();\r\n      }\r\n    };\r\n  }, [videoRef]);\r\n\r\n  useEffect(() => {\r\n    if (!isInitialized || !videoRef?.current || !canvasRef.current) return;\r\n\r\n    const video = videoRef.current;\r\n    const canvas = canvasRef.current;\r\n    \r\n    // Match canvas size to video\r\n    const updateCanvasSize = () => {\r\n      canvas.width = video.videoWidth || video.clientWidth;\r\n      canvas.height = video.videoHeight || video.clientHeight;\r\n    };\r\n\r\n    const processFrame = async () => {\r\n      if (video.paused || video.ended || !isPlaying) return;\r\n      \r\n      try {\r\n        updateCanvasSize();\r\n        await poseRef.current.send({ image: video });\r\n      } catch (error) {\r\n        console.error('Pose detection error:', error);\r\n      }\r\n\r\n      if (isPlaying && !video.paused && !video.ended) {\r\n        requestAnimationFrame(processFrame);\r\n      }\r\n    };\r\n\r\n    if (isPlaying) {\r\n      if (video.readyState >= 2) {\r\n        processFrame();\r\n      } else {\r\n        video.addEventListener('loadeddata', processFrame, { once: true });\r\n      }\r\n    }\r\n\r\n    // Clean up canvas when not playing\r\n    if (!isPlaying) {\r\n      const ctx = canvas.getContext('2d');\r\n      ctx.clearRect(0, 0, canvas.width, canvas.height);\r\n    }\r\n  }, [isPlaying, isInitialized]);\r\n\r\n  const onResults = (results) => {\r\n    const canvas = canvasRef.current;\r\n    if (!canvas) return;\r\n\r\n    const ctx = canvas.getContext('2d');\r\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\r\n\r\n    if (results.poseLandmarks) {\r\n      // Draw skeleton connections\r\n      drawConnectors(ctx, results.poseLandmarks, POSE_CONNECTIONS, {\r\n        color: '#00FF00',\r\n        lineWidth: 2\r\n      });\r\n\r\n      // Draw keypoints\r\n      drawLandmarks(ctx, results.poseLandmarks, {\r\n        color: '#FF0000',\r\n        radius: 3\r\n      });\r\n\r\n      // Pass keypoints to parent component\r\n      if (onKeypointsDetected) {\r\n        onKeypointsDetected(results.poseLandmarks);\r\n      }\r\n    }\r\n  };\r\n\r\n  return (\r\n    <canvas\r\n      ref={canvasRef}\r\n      style={{\r\n        position: 'absolute',\r\n        top: 0,\r\n        left: 0,\r\n        width: '100%',\r\n        height: '100%',\r\n        pointerEvents: 'none',\r\n        zIndex: 10\r\n      }}\r\n    />\r\n  );\r\n};\r\n\r\nexport default KeypointOverlay;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}