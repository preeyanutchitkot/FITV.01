{"ast":null,"code":"var _jsxFileName = \"C:\\\\Fit\\\\frontend\\\\src\\\\services\\\\KeypointsService.js\",\n  _s = $RefreshSig$();\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n// KeypointsService.js - Service ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ keypoints API\n\nclass KeypointsService {\n  constructor(baseURL = 'http://localhost:8000') {\n    this.baseURL = baseURL;\n  }\n\n  // ‡∏≠‡∏±‡∏û‡πÇ‡∏´‡∏•‡∏î keypoints ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö video segment\n  async uploadKeypoints(videoId, segmentId, keypointsData) {\n    try {\n      const response = await fetch(`${this.baseURL}/keypoints/videos/${videoId}/segments/${segmentId}/upload`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          keypoints_data: keypointsData\n        })\n      });\n      if (!response.ok) {\n        throw new Error(`HTTP error! status: ${response.status}`);\n      }\n      return await response.json();\n    } catch (error) {\n      console.error('Error uploading keypoints:', error);\n      throw error;\n    }\n  }\n\n  // ‡πÇ‡∏´‡∏•‡∏î keypoints ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö video segment\n  async loadKeypoints(videoId, segmentId) {\n    try {\n      const response = await fetch(`${this.baseURL}/keypoints/videos/${videoId}/segments/${segmentId}/load`);\n      if (!response.ok) {\n        throw new Error(`HTTP error! status: ${response.status}`);\n      }\n      return await response.json();\n    } catch (error) {\n      console.error('Error loading keypoints:', error);\n      throw error;\n    }\n  }\n\n  // üéØ Core Function: ‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö keypoints ‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á trainer ‡πÅ‡∏•‡∏∞ trainee\n  calculatePoseAccuracy(trainerPose, traineePose) {\n    if (!trainerPose || !traineePose || trainerPose.length !== traineePose.length) {\n      return 0;\n    }\n\n    // ‡∏Å‡∏£‡∏≠‡∏á‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏à‡∏∏‡∏î‡∏ó‡∏µ‡πà‡∏°‡∏µ visibility > 0.5\n    const validPairs = [];\n    for (let i = 0; i < trainerPose.length; i++) {\n      if (trainerPose[i].visibility > 0.5 && traineePose[i].visibility > 0.5) {\n        validPairs.push({\n          trainer: trainerPose[i],\n          trainee: traineePose[i]\n        });\n      }\n    }\n    if (validPairs.length === 0) return 0;\n\n    // ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏µ‡πà 1: Cosine Similarity\n    const cosineSim = this.calculateCosineSimilarity(trainerPose, traineePose);\n\n    // ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏µ‡πà 2: Angle Similarity (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏ï‡πà‡∏≠‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç)\n    const angleSim = this.calculateAngleSimilarity(trainerPose, traineePose);\n\n    // ‡∏£‡∏ß‡∏°‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏≠‡∏á‡∏ß‡∏¥‡∏ò‡∏µ (60% angle + 40% cosine)\n    const finalScore = Math.round(angleSim * 0.6 + cosineSim * 0.4);\n    return Math.max(0, Math.min(100, finalScore));\n  }\n\n  // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì Cosine Similarity\n  calculateCosineSimilarity(trainerPose, traineePose) {\n    const flatten = pose => pose.flatMap(p => [p.x, p.y]);\n    const trainerVector = flatten(trainerPose);\n    const traineeVector = flatten(traineePose);\n    let dot = 0,\n      normA = 0,\n      normB = 0;\n    for (let i = 0; i < trainerVector.length; i++) {\n      dot += trainerVector[i] * traineeVector[i];\n      normA += trainerVector[i] ** 2;\n      normB += traineeVector[i] ** 2;\n    }\n    const similarity = dot / (Math.sqrt(normA) * Math.sqrt(normB));\n    return Math.round(similarity * 100);\n  }\n\n  // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì Angle Similarity ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏ï‡πà‡∏≠‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç\n  calculateAngleSimilarity(trainerPose, traineePose) {\n    // ‡∏à‡∏∏‡∏î‡∏Ç‡πâ‡∏≠‡∏ï‡πà‡∏≠‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç [‡∏à‡∏∏‡∏î‡∏ó‡∏µ‡πà1, ‡∏à‡∏∏‡∏î‡∏Å‡∏•‡∏≤‡∏á, ‡∏à‡∏∏‡∏î‡∏ó‡∏µ‡πà3]\n    const joints = [[11, 13, 15],\n    // ‡πÅ‡∏Ç‡∏ô‡∏ã‡πâ‡∏≤‡∏¢ (‡πÑ‡∏´‡∏•‡πà-‡∏®‡∏≠‡∏Å-‡∏Ç‡πâ‡∏≠‡∏°‡∏∑‡∏≠)\n    [12, 14, 16],\n    // ‡πÅ‡∏Ç‡∏ô‡∏Ç‡∏ß‡∏≤ (‡πÑ‡∏´‡∏•‡πà-‡∏®‡∏≠‡∏Å-‡∏Ç‡πâ‡∏≠‡∏°‡∏∑‡∏≠)\n    [23, 25, 27],\n    // ‡∏Ç‡∏≤‡∏ã‡πâ‡∏≤‡∏¢ (‡∏™‡∏∞‡πÇ‡∏û‡∏Å-‡πÄ‡∏Ç‡πà‡∏≤-‡∏Ç‡πâ‡∏≠‡πÄ‡∏ó‡πâ‡∏≤)\n    [24, 26, 28],\n    // ‡∏Ç‡∏≤‡∏Ç‡∏ß‡∏≤ (‡∏™‡∏∞‡πÇ‡∏û‡∏Å-‡πÄ‡∏Ç‡πà‡∏≤-‡∏Ç‡πâ‡∏≠‡πÄ‡∏ó‡πâ‡∏≤)\n    [11, 23, 25],\n    // ‡∏•‡∏≥‡∏ï‡∏±‡∏ß‡∏ã‡πâ‡∏≤‡∏¢ (‡πÑ‡∏´‡∏•‡πà-‡∏™‡∏∞‡πÇ‡∏û‡∏Å-‡πÄ‡∏Ç‡πà‡∏≤)\n    [12, 24, 26] // ‡∏•‡∏≥‡∏ï‡∏±‡∏ß‡∏Ç‡∏ß‡∏≤ (‡πÑ‡∏´‡∏•‡πà-‡∏™‡∏∞‡πÇ‡∏û‡∏Å-‡πÄ‡∏Ç‡πà‡∏≤)\n    ];\n    let totalDiff = 0;\n    let validJoints = 0;\n    joints.forEach(([a, b, c]) => {\n      if (this.isValidJoint(trainerPose, a, b, c) && this.isValidJoint(traineePose, a, b, c)) {\n        const trainerAngle = this.calculateAngle(trainerPose[a], trainerPose[b], trainerPose[c]);\n        const traineeAngle = this.calculateAngle(traineePose[a], traineePose[b], traineePose[c]);\n        const angleDiff = Math.abs(trainerAngle - traineeAngle);\n        totalDiff += Math.min(angleDiff, 180 - angleDiff); // ‡πÉ‡∏ä‡πâ‡∏°‡∏∏‡∏°‡∏ó‡∏µ‡πà‡πÄ‡∏•‡πá‡∏Å‡∏Å‡∏ß‡πà‡∏≤\n        validJoints++;\n      }\n    });\n    if (validJoints === 0) return 0;\n    const avgDiff = totalDiff / validJoints;\n    // ‡πÅ‡∏õ‡∏•‡∏á‡∏ú‡∏•‡∏ï‡πà‡∏≤‡∏á‡∏°‡∏∏‡∏°‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô (‡∏°‡∏∏‡∏°‡∏ï‡πà‡∏≤‡∏á 0¬∞ = 100%, ‡∏°‡∏∏‡∏°‡∏ï‡πà‡∏≤‡∏á 45¬∞ = 0%)\n    const score = Math.max(0, 100 - avgDiff * 100 / 45);\n    return Math.round(score);\n  }\n\n  // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏°‡∏∏‡∏°‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á 3 ‡∏à‡∏∏‡∏î\n  calculateAngle(p1, p2, p3) {\n    const a = Math.hypot(p2.x - p3.x, p2.y - p3.y);\n    const b = Math.hypot(p1.x - p3.x, p1.y - p3.y);\n    const c = Math.hypot(p1.x - p2.x, p1.y - p2.y);\n    const angle = Math.acos((b ** 2 + c ** 2 - a ** 2) / (2 * b * c));\n    return angle * (180 / Math.PI);\n  }\n\n  // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏Ç‡πâ‡∏≠‡∏ï‡πà‡∏≠‡∏°‡∏µ visibility ‡∏î‡∏µ‡∏û‡∏≠‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà\n  isValidJoint(pose, a, b, c) {\n    var _pose$a, _pose$b, _pose$c;\n    return ((_pose$a = pose[a]) === null || _pose$a === void 0 ? void 0 : _pose$a.visibility) > 0.5 && ((_pose$b = pose[b]) === null || _pose$b === void 0 ? void 0 : _pose$b.visibility) > 0.5 && ((_pose$c = pose[c]) === null || _pose$c === void 0 ? void 0 : _pose$c.visibility) > 0.5;\n  }\n\n  // ‡∏™‡∏£‡πâ‡∏≤‡∏á feedback ‡∏ï‡∏≤‡∏°‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô\n  generateFeedback(accuracy) {\n    if (accuracy >= 90) {\n      return {\n        level: \"excellent\",\n        message: \"Perfect! üî• Your form is excellent!\",\n        color: \"#4CAF50\"\n      };\n    } else if (accuracy >= 75) {\n      return {\n        level: \"good\",\n        message: \"Great job! üëç Minor adjustments needed.\",\n        color: \"#8BC34A\"\n      };\n    } else if (accuracy >= 60) {\n      return {\n        level: \"fair\",\n        message: \"Good effort! üí™ Try to match the trainer's pose.\",\n        color: \"#FF9800\"\n      };\n    } else if (accuracy >= 40) {\n      return {\n        level: \"needs-improvement\",\n        message: \"Keep trying! üéØ Focus on your posture.\",\n        color: \"#FF5722\"\n      };\n    } else {\n      return {\n        level: \"poor\",\n        message: \"Take your time ‚è∞ Follow the trainer closely.\",\n        color: \"#F44336\"\n      };\n    }\n  }\n\n  // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö session\n  calculateSessionScore(accuracyHistory) {\n    if (!accuracyHistory || accuracyHistory.length === 0) return 0;\n    const sum = accuracyHistory.reduce((acc, val) => acc + val, 0);\n    return Math.round(sum / accuracyHistory.length);\n  }\n\n  // ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏à‡∏∏‡∏î‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á\n  analyzeWeakPoints(trainerPose, traineePose) {\n    const joints = {\n      'Left Arm': [11, 13, 15],\n      'Right Arm': [12, 14, 16],\n      'Left Leg': [23, 25, 27],\n      'Right Leg': [24, 26, 28],\n      'Core': [11, 23, 24]\n    };\n    const analysis = {};\n    Object.entries(joints).forEach(([jointName, [a, b, c]]) => {\n      if (this.isValidJoint(trainerPose, a, b, c) && this.isValidJoint(traineePose, a, b, c)) {\n        const trainerAngle = this.calculateAngle(trainerPose[a], trainerPose[b], trainerPose[c]);\n        const traineeAngle = this.calculateAngle(traineePose[a], traineePose[b], traineePose[c]);\n        const diff = Math.abs(trainerAngle - traineeAngle);\n        analysis[jointName] = {\n          accuracy: Math.max(0, 100 - diff * 100 / 45),\n          needsImprovement: diff > 15\n        };\n      }\n    });\n    return analysis;\n  }\n\n  // ‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö keypoints\n  async compareKeypoints(videoId, segmentId, traineeKeypoints, timestamp) {\n    try {\n      const response = await fetch(`${this.baseURL}/keypoints/videos/${videoId}/segments/${segmentId}/compare`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          keypoints: traineeKeypoints,\n          timestamp: timestamp\n        })\n      });\n      if (!response.ok) {\n        throw new Error(`HTTP error! status: ${response.status}`);\n      }\n      return await response.json();\n    } catch (error) {\n      console.error('Error comparing keypoints:', error);\n      throw error;\n    }\n  }\n\n  // ‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• segments ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏Ç‡∏≠‡∏á video\n  async getVideoSegments(videoId) {\n    try {\n      const response = await fetch(`${this.baseURL}/keypoints/videos/${videoId}/segments`);\n      if (!response.ok) {\n        throw new Error(`HTTP error! status: ${response.status}`);\n      }\n      return await response.json();\n    } catch (error) {\n      console.error('Error getting video segments:', error);\n      throw error;\n    }\n  }\n\n  // ‡∏•‡∏ö keypoints\n  async deleteKeypoints(videoId, segmentId) {\n    try {\n      const response = await fetch(`${this.baseURL}/keypoints/videos/${videoId}/segments/${segmentId}/keypoints`, {\n        method: 'DELETE'\n      });\n      if (!response.ok) {\n        throw new Error(`HTTP error! status: ${response.status}`);\n      }\n      return await response.json();\n    } catch (error) {\n      console.error('Error deleting keypoints:', error);\n      throw error;\n    }\n  }\n}\n\n// MediaPipe integration ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö real-time pose detection\nclass PoseDetector {\n  constructor() {\n    this.pose = null;\n    this.camera = null;\n    this.isInitialized = false;\n  }\n  async initialize() {\n    if (this.isInitialized) return;\n    try {\n      // Import MediaPipe (‡πÉ‡∏ä‡πâ CDN ‡∏´‡∏£‡∏∑‡∏≠ npm install @mediapipe/pose)\n      const {\n        Pose\n      } = await import('@mediapipe/pose');\n      const {\n        Camera\n      } = await import('@mediapipe/camera_utils');\n      this.pose = new Pose({\n        locateFile: file => {\n          return `https://cdn.jsdelivr.net/npm/@mediapipe/pose/${file}`;\n        }\n      });\n      this.pose.setOptions({\n        modelComplexity: 1,\n        smoothLandmarks: true,\n        enableSegmentation: false,\n        smoothSegmentation: true,\n        minDetectionConfidence: 0.5,\n        minTrackingConfidence: 0.5\n      });\n      this.pose.onResults(this.onResults.bind(this));\n      this.isInitialized = true;\n    } catch (error) {\n      console.error('Error initializing pose detector:', error);\n      throw error;\n    }\n  }\n  async startCamera(videoElement, onPoseDetected) {\n    if (!this.isInitialized) {\n      await this.initialize();\n    }\n    this.onPoseDetected = onPoseDetected;\n    try {\n      this.camera = new Camera(videoElement, {\n        onFrame: async () => {\n          await this.pose.send({\n            image: videoElement\n          });\n        },\n        width: 640,\n        height: 480\n      });\n      await this.camera.start();\n    } catch (error) {\n      console.error('Error starting camera:', error);\n      throw error;\n    }\n  }\n  onResults(results) {\n    if (results.poseLandmarks && this.onPoseDetected) {\n      // Convert MediaPipe landmarks to our format\n      const keypoints = results.poseLandmarks.map(landmark => ({\n        x: landmark.x,\n        y: landmark.y,\n        z: landmark.z,\n        visibility: landmark.visibility\n      }));\n      this.onPoseDetected(keypoints);\n    }\n  }\n  stop() {\n    if (this.camera) {\n      this.camera.stop();\n    }\n  }\n}\n\n// React Component ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á\nconst WorkoutComparison = ({\n  videoId,\n  segmentId\n}) => {\n  _s();\n  const [keypointsService] = useState(new KeypointsService());\n  const [poseDetector] = useState(new PoseDetector());\n  const [currentScore, setCurrentScore] = useState(0);\n  const [feedback, setFeedback] = useState('');\n  const [isComparing, setIsComparing] = useState(false);\n  const videoRef = useRef(null);\n  const canvasRef = useRef(null);\n  useEffect(() => {\n    // ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô camera ‡πÅ‡∏•‡∏∞ pose detection\n    const initializePoseDetection = async () => {\n      try {\n        await poseDetector.startCamera(videoRef.current, handlePoseDetected);\n      } catch (error) {\n        console.error('Failed to initialize pose detection:', error);\n      }\n    };\n    initializePoseDetection();\n    return () => {\n      poseDetector.stop();\n    };\n  }, []);\n  const handlePoseDetected = async keypoints => {\n    if (!isComparing) return;\n    try {\n      // ‡πÉ‡∏ä‡πâ‡πÄ‡∏ß‡∏•‡∏≤‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô‡∏Ç‡∏≠‡∏á‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠ trainer\n      const currentTime = getCurrentTrainerVideoTime();\n\n      // ‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏Å‡∏±‡∏ö trainer keypoints\n      const result = await keypointsService.compareKeypoints(videoId, segmentId, keypoints, currentTime);\n      setCurrentScore(result.similarity_score);\n      setFeedback(result.feedback);\n\n      // ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏ö‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠\n      displayComparisonResult(result);\n    } catch (error) {\n      console.error('Error during pose comparison:', error);\n    }\n  };\n  const startComparison = () => {\n    setIsComparing(true);\n  };\n  const stopComparison = () => {\n    setIsComparing(false);\n  };\n  const displayComparisonResult = result => {\n    // ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÅ‡∏•‡∏∞ feedback ‡∏ö‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠\n    // ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏û‡∏¥‡πà‡∏° visual feedback ‡πÄ‡∏ä‡πà‡∏ô ‡∏™‡∏µ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß/‡πÅ‡∏î‡∏á ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ó‡πà‡∏≤‡∏ñ‡∏π‡∏Å/‡∏ú‡∏¥‡∏î\n    console.log('Comparison result:', result);\n  };\n  const getCurrentTrainerVideoTime = () => {\n    // ‡∏î‡∏∂‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô‡∏à‡∏≤‡∏Å‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠ trainer ‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏•‡πà‡∏ô\n    // ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö video player component\n    return 0; // placeholder\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"workout-comparison\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"video-container\",\n      children: [/*#__PURE__*/_jsxDEV(\"video\", {\n        ref: videoRef,\n        autoPlay: true,\n        playsInline: true,\n        muted: true,\n        className: \"trainee-video\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 464,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"canvas\", {\n        ref: canvasRef,\n        className: \"pose-overlay\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 471,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 463,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"comparison-controls\",\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: startComparison,\n        disabled: isComparing,\n        className: \"btn-start\",\n        children: \"Start Comparison\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 478,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: stopComparison,\n        disabled: !isComparing,\n        className: \"btn-stop\",\n        children: \"Stop Comparison\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 485,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 477,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"feedback-panel\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"score-display\",\n        children: /*#__PURE__*/_jsxDEV(\"h3\", {\n          children: [\"Score: \", (currentScore * 100).toFixed(1), \"%\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 496,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 495,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"feedback-text\",\n        children: /*#__PURE__*/_jsxDEV(\"p\", {\n          children: feedback\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 499,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 498,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 494,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 462,\n    columnNumber: 9\n  }, this);\n};\n_s(WorkoutComparison, \"G7C253yq6coKgZ2DhiBFLEQwLx0=\");\n_c = WorkoutComparison;\nexport { KeypointsService, PoseDetector, WorkoutComparison };\nvar _c;\n$RefreshReg$(_c, \"WorkoutComparison\");","map":{"version":3,"names":["KeypointsService","constructor","baseURL","uploadKeypoints","videoId","segmentId","keypointsData","response","fetch","method","headers","body","JSON","stringify","keypoints_data","ok","Error","status","json","error","console","loadKeypoints","calculatePoseAccuracy","trainerPose","traineePose","length","validPairs","i","visibility","push","trainer","trainee","cosineSim","calculateCosineSimilarity","angleSim","calculateAngleSimilarity","finalScore","Math","round","max","min","flatten","pose","flatMap","p","x","y","trainerVector","traineeVector","dot","normA","normB","similarity","sqrt","joints","totalDiff","validJoints","forEach","a","b","c","isValidJoint","trainerAngle","calculateAngle","traineeAngle","angleDiff","abs","avgDiff","score","p1","p2","p3","hypot","angle","acos","PI","_pose$a","_pose$b","_pose$c","generateFeedback","accuracy","level","message","color","calculateSessionScore","accuracyHistory","sum","reduce","acc","val","analyzeWeakPoints","analysis","Object","entries","jointName","diff","needsImprovement","compareKeypoints","traineeKeypoints","timestamp","keypoints","getVideoSegments","deleteKeypoints","PoseDetector","camera","isInitialized","initialize","Pose","Camera","locateFile","file","setOptions","modelComplexity","smoothLandmarks","enableSegmentation","smoothSegmentation","minDetectionConfidence","minTrackingConfidence","onResults","bind","startCamera","videoElement","onPoseDetected","onFrame","send","image","width","height","start","results","poseLandmarks","map","landmark","z","stop","WorkoutComparison","_s","keypointsService","useState","poseDetector","currentScore","setCurrentScore","feedback","setFeedback","isComparing","setIsComparing","videoRef","useRef","canvasRef","useEffect","initializePoseDetection","current","handlePoseDetected","currentTime","getCurrentTrainerVideoTime","result","similarity_score","displayComparisonResult","startComparison","stopComparison","log","_jsxDEV","className","children","ref","autoPlay","playsInline","muted","fileName","_jsxFileName","lineNumber","columnNumber","onClick","disabled","toFixed","_c","$RefreshReg$"],"sources":["C:/Fit/frontend/src/services/KeypointsService.js"],"sourcesContent":["// KeypointsService.js - Service ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ keypoints API\r\n\r\nclass KeypointsService {\r\n    constructor(baseURL = 'http://localhost:8000') {\r\n        this.baseURL = baseURL;\r\n    }\r\n\r\n    // ‡∏≠‡∏±‡∏û‡πÇ‡∏´‡∏•‡∏î keypoints ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö video segment\r\n    async uploadKeypoints(videoId, segmentId, keypointsData) {\r\n        try {\r\n            const response = await fetch(\r\n                `${this.baseURL}/keypoints/videos/${videoId}/segments/${segmentId}/upload`,\r\n                {\r\n                    method: 'POST',\r\n                    headers: {\r\n                        'Content-Type': 'application/json',\r\n                    },\r\n                    body: JSON.stringify({\r\n                        keypoints_data: keypointsData\r\n                    })\r\n                }\r\n            );\r\n\r\n            if (!response.ok) {\r\n                throw new Error(`HTTP error! status: ${response.status}`);\r\n            }\r\n\r\n            return await response.json();\r\n        } catch (error) {\r\n            console.error('Error uploading keypoints:', error);\r\n            throw error;\r\n        }\r\n    }\r\n\r\n    // ‡πÇ‡∏´‡∏•‡∏î keypoints ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö video segment\r\n    async loadKeypoints(videoId, segmentId) {\r\n        try {\r\n            const response = await fetch(\r\n                `${this.baseURL}/keypoints/videos/${videoId}/segments/${segmentId}/load`\r\n            );\r\n\r\n            if (!response.ok) {\r\n                throw new Error(`HTTP error! status: ${response.status}`);\r\n            }\r\n\r\n            return await response.json();\r\n        } catch (error) {\r\n            console.error('Error loading keypoints:', error);\r\n            throw error;\r\n        }\r\n    }\r\n\r\n    // üéØ Core Function: ‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö keypoints ‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á trainer ‡πÅ‡∏•‡∏∞ trainee\r\n    calculatePoseAccuracy(trainerPose, traineePose) {\r\n        if (!trainerPose || !traineePose || \r\n            trainerPose.length !== traineePose.length) {\r\n            return 0;\r\n        }\r\n\r\n        // ‡∏Å‡∏£‡∏≠‡∏á‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏à‡∏∏‡∏î‡∏ó‡∏µ‡πà‡∏°‡∏µ visibility > 0.5\r\n        const validPairs = [];\r\n        for (let i = 0; i < trainerPose.length; i++) {\r\n            if (trainerPose[i].visibility > 0.5 && traineePose[i].visibility > 0.5) {\r\n                validPairs.push({ trainer: trainerPose[i], trainee: traineePose[i] });\r\n            }\r\n        }\r\n\r\n        if (validPairs.length === 0) return 0;\r\n\r\n        // ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏µ‡πà 1: Cosine Similarity\r\n        const cosineSim = this.calculateCosineSimilarity(trainerPose, traineePose);\r\n        \r\n        // ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏µ‡πà 2: Angle Similarity (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏ï‡πà‡∏≠‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç)\r\n        const angleSim = this.calculateAngleSimilarity(trainerPose, traineePose);\r\n        \r\n        // ‡∏£‡∏ß‡∏°‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏≠‡∏á‡∏ß‡∏¥‡∏ò‡∏µ (60% angle + 40% cosine)\r\n        const finalScore = Math.round(angleSim * 0.6 + cosineSim * 0.4);\r\n        \r\n        return Math.max(0, Math.min(100, finalScore));\r\n    }\r\n\r\n    // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì Cosine Similarity\r\n    calculateCosineSimilarity(trainerPose, traineePose) {\r\n        const flatten = (pose) => pose.flatMap(p => [p.x, p.y]);\r\n        const trainerVector = flatten(trainerPose);\r\n        const traineeVector = flatten(traineePose);\r\n\r\n        let dot = 0, normA = 0, normB = 0;\r\n        for (let i = 0; i < trainerVector.length; i++) {\r\n            dot += trainerVector[i] * traineeVector[i];\r\n            normA += trainerVector[i] ** 2;\r\n            normB += traineeVector[i] ** 2;\r\n        }\r\n\r\n        const similarity = dot / (Math.sqrt(normA) * Math.sqrt(normB));\r\n        return Math.round(similarity * 100);\r\n    }\r\n\r\n    // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì Angle Similarity ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏ï‡πà‡∏≠‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç\r\n    calculateAngleSimilarity(trainerPose, traineePose) {\r\n        // ‡∏à‡∏∏‡∏î‡∏Ç‡πâ‡∏≠‡∏ï‡πà‡∏≠‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç [‡∏à‡∏∏‡∏î‡∏ó‡∏µ‡πà1, ‡∏à‡∏∏‡∏î‡∏Å‡∏•‡∏≤‡∏á, ‡∏à‡∏∏‡∏î‡∏ó‡∏µ‡πà3]\r\n        const joints = [\r\n            [11, 13, 15], // ‡πÅ‡∏Ç‡∏ô‡∏ã‡πâ‡∏≤‡∏¢ (‡πÑ‡∏´‡∏•‡πà-‡∏®‡∏≠‡∏Å-‡∏Ç‡πâ‡∏≠‡∏°‡∏∑‡∏≠)\r\n            [12, 14, 16], // ‡πÅ‡∏Ç‡∏ô‡∏Ç‡∏ß‡∏≤ (‡πÑ‡∏´‡∏•‡πà-‡∏®‡∏≠‡∏Å-‡∏Ç‡πâ‡∏≠‡∏°‡∏∑‡∏≠)\r\n            [23, 25, 27], // ‡∏Ç‡∏≤‡∏ã‡πâ‡∏≤‡∏¢ (‡∏™‡∏∞‡πÇ‡∏û‡∏Å-‡πÄ‡∏Ç‡πà‡∏≤-‡∏Ç‡πâ‡∏≠‡πÄ‡∏ó‡πâ‡∏≤)\r\n            [24, 26, 28], // ‡∏Ç‡∏≤‡∏Ç‡∏ß‡∏≤ (‡∏™‡∏∞‡πÇ‡∏û‡∏Å-‡πÄ‡∏Ç‡πà‡∏≤-‡∏Ç‡πâ‡∏≠‡πÄ‡∏ó‡πâ‡∏≤)\r\n            [11, 23, 25], // ‡∏•‡∏≥‡∏ï‡∏±‡∏ß‡∏ã‡πâ‡∏≤‡∏¢ (‡πÑ‡∏´‡∏•‡πà-‡∏™‡∏∞‡πÇ‡∏û‡∏Å-‡πÄ‡∏Ç‡πà‡∏≤)\r\n            [12, 24, 26], // ‡∏•‡∏≥‡∏ï‡∏±‡∏ß‡∏Ç‡∏ß‡∏≤ (‡πÑ‡∏´‡∏•‡πà-‡∏™‡∏∞‡πÇ‡∏û‡∏Å-‡πÄ‡∏Ç‡πà‡∏≤)\r\n        ];\r\n\r\n        let totalDiff = 0;\r\n        let validJoints = 0;\r\n\r\n        joints.forEach(([a, b, c]) => {\r\n            if (this.isValidJoint(trainerPose, a, b, c) && \r\n                this.isValidJoint(traineePose, a, b, c)) {\r\n                \r\n                const trainerAngle = this.calculateAngle(\r\n                    trainerPose[a], trainerPose[b], trainerPose[c]\r\n                );\r\n                const traineeAngle = this.calculateAngle(\r\n                    traineePose[a], traineePose[b], traineePose[c]\r\n                );\r\n                \r\n                const angleDiff = Math.abs(trainerAngle - traineeAngle);\r\n                totalDiff += Math.min(angleDiff, 180 - angleDiff); // ‡πÉ‡∏ä‡πâ‡∏°‡∏∏‡∏°‡∏ó‡∏µ‡πà‡πÄ‡∏•‡πá‡∏Å‡∏Å‡∏ß‡πà‡∏≤\r\n                validJoints++;\r\n            }\r\n        });\r\n\r\n        if (validJoints === 0) return 0;\r\n\r\n        const avgDiff = totalDiff / validJoints;\r\n        // ‡πÅ‡∏õ‡∏•‡∏á‡∏ú‡∏•‡∏ï‡πà‡∏≤‡∏á‡∏°‡∏∏‡∏°‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô (‡∏°‡∏∏‡∏°‡∏ï‡πà‡∏≤‡∏á 0¬∞ = 100%, ‡∏°‡∏∏‡∏°‡∏ï‡πà‡∏≤‡∏á 45¬∞ = 0%)\r\n        const score = Math.max(0, 100 - (avgDiff * 100 / 45));\r\n        return Math.round(score);\r\n    }\r\n\r\n    // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏°‡∏∏‡∏°‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á 3 ‡∏à‡∏∏‡∏î\r\n    calculateAngle(p1, p2, p3) {\r\n        const a = Math.hypot(p2.x - p3.x, p2.y - p3.y);\r\n        const b = Math.hypot(p1.x - p3.x, p1.y - p3.y);\r\n        const c = Math.hypot(p1.x - p2.x, p1.y - p2.y);\r\n        \r\n        const angle = Math.acos((b ** 2 + c ** 2 - a ** 2) / (2 * b * c));\r\n        return angle * (180 / Math.PI);\r\n    }\r\n\r\n    // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏Ç‡πâ‡∏≠‡∏ï‡πà‡∏≠‡∏°‡∏µ visibility ‡∏î‡∏µ‡∏û‡∏≠‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà\r\n    isValidJoint(pose, a, b, c) {\r\n        return pose[a]?.visibility > 0.5 && \r\n               pose[b]?.visibility > 0.5 && \r\n               pose[c]?.visibility > 0.5;\r\n    }\r\n\r\n    // ‡∏™‡∏£‡πâ‡∏≤‡∏á feedback ‡∏ï‡∏≤‡∏°‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô\r\n    generateFeedback(accuracy) {\r\n        if (accuracy >= 90) {\r\n            return {\r\n                level: \"excellent\",\r\n                message: \"Perfect! üî• Your form is excellent!\",\r\n                color: \"#4CAF50\"\r\n            };\r\n        } else if (accuracy >= 75) {\r\n            return {\r\n                level: \"good\",\r\n                message: \"Great job! üëç Minor adjustments needed.\",\r\n                color: \"#8BC34A\"\r\n            };\r\n        } else if (accuracy >= 60) {\r\n            return {\r\n                level: \"fair\",\r\n                message: \"Good effort! üí™ Try to match the trainer's pose.\",\r\n                color: \"#FF9800\"\r\n            };\r\n        } else if (accuracy >= 40) {\r\n            return {\r\n                level: \"needs-improvement\",\r\n                message: \"Keep trying! üéØ Focus on your posture.\",\r\n                color: \"#FF5722\"\r\n            };\r\n        } else {\r\n            return {\r\n                level: \"poor\",\r\n                message: \"Take your time ‚è∞ Follow the trainer closely.\",\r\n                color: \"#F44336\"\r\n            };\r\n        }\r\n    }\r\n\r\n    // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö session\r\n    calculateSessionScore(accuracyHistory) {\r\n        if (!accuracyHistory || accuracyHistory.length === 0) return 0;\r\n        \r\n        const sum = accuracyHistory.reduce((acc, val) => acc + val, 0);\r\n        return Math.round(sum / accuracyHistory.length);\r\n    }\r\n\r\n    // ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏à‡∏∏‡∏î‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á\r\n    analyzeWeakPoints(trainerPose, traineePose) {\r\n        const joints = {\r\n            'Left Arm': [11, 13, 15],\r\n            'Right Arm': [12, 14, 16],\r\n            'Left Leg': [23, 25, 27],\r\n            'Right Leg': [24, 26, 28],\r\n            'Core': [11, 23, 24]\r\n        };\r\n\r\n        const analysis = {};\r\n        \r\n        Object.entries(joints).forEach(([jointName, [a, b, c]]) => {\r\n            if (this.isValidJoint(trainerPose, a, b, c) && \r\n                this.isValidJoint(traineePose, a, b, c)) {\r\n                \r\n                const trainerAngle = this.calculateAngle(\r\n                    trainerPose[a], trainerPose[b], trainerPose[c]\r\n                );\r\n                const traineeAngle = this.calculateAngle(\r\n                    traineePose[a], traineePose[b], traineePose[c]\r\n                );\r\n                \r\n                const diff = Math.abs(trainerAngle - traineeAngle);\r\n                analysis[jointName] = {\r\n                    accuracy: Math.max(0, 100 - (diff * 100 / 45)),\r\n                    needsImprovement: diff > 15\r\n                };\r\n            }\r\n        });\r\n\r\n        return analysis;\r\n    }\r\n\r\n    // ‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö keypoints\r\n    async compareKeypoints(videoId, segmentId, traineeKeypoints, timestamp) {\r\n        try {\r\n            const response = await fetch(\r\n                `${this.baseURL}/keypoints/videos/${videoId}/segments/${segmentId}/compare`,\r\n                {\r\n                    method: 'POST',\r\n                    headers: {\r\n                        'Content-Type': 'application/json',\r\n                    },\r\n                    body: JSON.stringify({\r\n                        keypoints: traineeKeypoints,\r\n                        timestamp: timestamp\r\n                    })\r\n                }\r\n            );\r\n\r\n            if (!response.ok) {\r\n                throw new Error(`HTTP error! status: ${response.status}`);\r\n            }\r\n\r\n            return await response.json();\r\n        } catch (error) {\r\n            console.error('Error comparing keypoints:', error);\r\n            throw error;\r\n        }\r\n    }\r\n\r\n    // ‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• segments ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏Ç‡∏≠‡∏á video\r\n    async getVideoSegments(videoId) {\r\n        try {\r\n            const response = await fetch(\r\n                `${this.baseURL}/keypoints/videos/${videoId}/segments`\r\n            );\r\n\r\n            if (!response.ok) {\r\n                throw new Error(`HTTP error! status: ${response.status}`);\r\n            }\r\n\r\n            return await response.json();\r\n        } catch (error) {\r\n            console.error('Error getting video segments:', error);\r\n            throw error;\r\n        }\r\n    }\r\n\r\n    // ‡∏•‡∏ö keypoints\r\n    async deleteKeypoints(videoId, segmentId) {\r\n        try {\r\n            const response = await fetch(\r\n                `${this.baseURL}/keypoints/videos/${videoId}/segments/${segmentId}/keypoints`,\r\n                {\r\n                    method: 'DELETE'\r\n                }\r\n            );\r\n\r\n            if (!response.ok) {\r\n                throw new Error(`HTTP error! status: ${response.status}`);\r\n            }\r\n\r\n            return await response.json();\r\n        } catch (error) {\r\n            console.error('Error deleting keypoints:', error);\r\n            throw error;\r\n        }\r\n    }\r\n}\r\n\r\n// MediaPipe integration ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö real-time pose detection\r\nclass PoseDetector {\r\n    constructor() {\r\n        this.pose = null;\r\n        this.camera = null;\r\n        this.isInitialized = false;\r\n    }\r\n\r\n    async initialize() {\r\n        if (this.isInitialized) return;\r\n\r\n        try {\r\n            // Import MediaPipe (‡πÉ‡∏ä‡πâ CDN ‡∏´‡∏£‡∏∑‡∏≠ npm install @mediapipe/pose)\r\n            const { Pose } = await import('@mediapipe/pose');\r\n            const { Camera } = await import('@mediapipe/camera_utils');\r\n\r\n            this.pose = new Pose({\r\n                locateFile: (file) => {\r\n                    return `https://cdn.jsdelivr.net/npm/@mediapipe/pose/${file}`;\r\n                }\r\n            });\r\n\r\n            this.pose.setOptions({\r\n                modelComplexity: 1,\r\n                smoothLandmarks: true,\r\n                enableSegmentation: false,\r\n                smoothSegmentation: true,\r\n                minDetectionConfidence: 0.5,\r\n                minTrackingConfidence: 0.5\r\n            });\r\n\r\n            this.pose.onResults(this.onResults.bind(this));\r\n            this.isInitialized = true;\r\n        } catch (error) {\r\n            console.error('Error initializing pose detector:', error);\r\n            throw error;\r\n        }\r\n    }\r\n\r\n    async startCamera(videoElement, onPoseDetected) {\r\n        if (!this.isInitialized) {\r\n            await this.initialize();\r\n        }\r\n\r\n        this.onPoseDetected = onPoseDetected;\r\n\r\n        try {\r\n            this.camera = new Camera(videoElement, {\r\n                onFrame: async () => {\r\n                    await this.pose.send({ image: videoElement });\r\n                },\r\n                width: 640,\r\n                height: 480\r\n            });\r\n\r\n            await this.camera.start();\r\n        } catch (error) {\r\n            console.error('Error starting camera:', error);\r\n            throw error;\r\n        }\r\n    }\r\n\r\n    onResults(results) {\r\n        if (results.poseLandmarks && this.onPoseDetected) {\r\n            // Convert MediaPipe landmarks to our format\r\n            const keypoints = results.poseLandmarks.map(landmark => ({\r\n                x: landmark.x,\r\n                y: landmark.y,\r\n                z: landmark.z,\r\n                visibility: landmark.visibility\r\n            }));\r\n\r\n            this.onPoseDetected(keypoints);\r\n        }\r\n    }\r\n\r\n    stop() {\r\n        if (this.camera) {\r\n            this.camera.stop();\r\n        }\r\n    }\r\n}\r\n\r\n// React Component ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á\r\nconst WorkoutComparison = ({ videoId, segmentId }) => {\r\n    const [keypointsService] = useState(new KeypointsService());\r\n    const [poseDetector] = useState(new PoseDetector());\r\n    const [currentScore, setCurrentScore] = useState(0);\r\n    const [feedback, setFeedback] = useState('');\r\n    const [isComparing, setIsComparing] = useState(false);\r\n\r\n    const videoRef = useRef(null);\r\n    const canvasRef = useRef(null);\r\n\r\n    useEffect(() => {\r\n        // ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô camera ‡πÅ‡∏•‡∏∞ pose detection\r\n        const initializePoseDetection = async () => {\r\n            try {\r\n                await poseDetector.startCamera(\r\n                    videoRef.current,\r\n                    handlePoseDetected\r\n                );\r\n            } catch (error) {\r\n                console.error('Failed to initialize pose detection:', error);\r\n            }\r\n        };\r\n\r\n        initializePoseDetection();\r\n\r\n        return () => {\r\n            poseDetector.stop();\r\n        };\r\n    }, []);\r\n\r\n    const handlePoseDetected = async (keypoints) => {\r\n        if (!isComparing) return;\r\n\r\n        try {\r\n            // ‡πÉ‡∏ä‡πâ‡πÄ‡∏ß‡∏•‡∏≤‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô‡∏Ç‡∏≠‡∏á‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠ trainer\r\n            const currentTime = getCurrentTrainerVideoTime();\r\n            \r\n            // ‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏Å‡∏±‡∏ö trainer keypoints\r\n            const result = await keypointsService.compareKeypoints(\r\n                videoId,\r\n                segmentId,\r\n                keypoints,\r\n                currentTime\r\n            );\r\n\r\n            setCurrentScore(result.similarity_score);\r\n            setFeedback(result.feedback);\r\n\r\n            // ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏ö‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠\r\n            displayComparisonResult(result);\r\n\r\n        } catch (error) {\r\n            console.error('Error during pose comparison:', error);\r\n        }\r\n    };\r\n\r\n    const startComparison = () => {\r\n        setIsComparing(true);\r\n    };\r\n\r\n    const stopComparison = () => {\r\n        setIsComparing(false);\r\n    };\r\n\r\n    const displayComparisonResult = (result) => {\r\n        // ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÅ‡∏•‡∏∞ feedback ‡∏ö‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠\r\n        // ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏û‡∏¥‡πà‡∏° visual feedback ‡πÄ‡∏ä‡πà‡∏ô ‡∏™‡∏µ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß/‡πÅ‡∏î‡∏á ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ó‡πà‡∏≤‡∏ñ‡∏π‡∏Å/‡∏ú‡∏¥‡∏î\r\n        console.log('Comparison result:', result);\r\n    };\r\n\r\n    const getCurrentTrainerVideoTime = () => {\r\n        // ‡∏î‡∏∂‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô‡∏à‡∏≤‡∏Å‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠ trainer ‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏•‡πà‡∏ô\r\n        // ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö video player component\r\n        return 0; // placeholder\r\n    };\r\n\r\n    return (\r\n        <div className=\"workout-comparison\">\r\n            <div className=\"video-container\">\r\n                <video\r\n                    ref={videoRef}\r\n                    autoPlay\r\n                    playsInline\r\n                    muted\r\n                    className=\"trainee-video\"\r\n                />\r\n                <canvas\r\n                    ref={canvasRef}\r\n                    className=\"pose-overlay\"\r\n                />\r\n            </div>\r\n            \r\n            <div className=\"comparison-controls\">\r\n                <button \r\n                    onClick={startComparison}\r\n                    disabled={isComparing}\r\n                    className=\"btn-start\"\r\n                >\r\n                    Start Comparison\r\n                </button>\r\n                <button \r\n                    onClick={stopComparison}\r\n                    disabled={!isComparing}\r\n                    className=\"btn-stop\"\r\n                >\r\n                    Stop Comparison\r\n                </button>\r\n            </div>\r\n\r\n            <div className=\"feedback-panel\">\r\n                <div className=\"score-display\">\r\n                    <h3>Score: {(currentScore * 100).toFixed(1)}%</h3>\r\n                </div>\r\n                <div className=\"feedback-text\">\r\n                    <p>{feedback}</p>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport { KeypointsService, PoseDetector, WorkoutComparison };"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}