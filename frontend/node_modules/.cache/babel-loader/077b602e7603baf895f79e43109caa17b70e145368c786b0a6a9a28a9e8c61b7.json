{"ast":null,"code":"var _jsxFileName = \"E:\\\\BackupFit\\\\frontend\\\\src\\\\pages\\\\GoogleOAuthCallback.js\",\n  _s = $RefreshSig$();\nimport React from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { jwtDecode } from '../utils/jwtDecode';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction GoogleOAuthCallback() {\n  _s();\n  const navigate = useNavigate();\n  React.useEffect(() => {\n    const handleOAuthCallback = () => {\n      try {\n        const params = new URLSearchParams(window.location.search);\n        const token = params.get('token');\n        if (token) {\n          // เก็บ token\n          localStorage.setItem('token', token);\n\n          // decode JWT\n          const payload = jwtDecode(token);\n          if (payload) {\n            // เก็บข้อมูล user\n            localStorage.setItem('user', JSON.stringify({\n              email: payload.email,\n              role: payload.role,\n              name: payload.name || ''\n            }));\n\n            // redirect ตาม role\n            switch (payload.role) {\n              case 'trainee':\n                navigate('/trainee');\n                break;\n              case 'trainer':\n                navigate('/trainer');\n                break;\n              case 'admin':\n                navigate('/admin');\n                break;\n              default:\n                navigate('/home');\n            }\n          } else {\n            console.error('Invalid token payload');\n            navigate('/home');\n          }\n        } else {\n          console.error('No token found in URL');\n          navigate('/login');\n        }\n      } catch (error) {\n        console.error('Error processing OAuth callback:', error);\n        navigate('/login');\n      }\n    };\n    handleOAuthCallback();\n  }, [navigate]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      textAlign: 'center',\n      marginTop: '50px'\n    },\n    children: \"\\u0E01\\u0E33\\u0E25\\u0E31\\u0E07\\u0E40\\u0E02\\u0E49\\u0E32\\u0E2A\\u0E39\\u0E48\\u0E23\\u0E30\\u0E1A\\u0E1A\\u0E14\\u0E49\\u0E27\\u0E22 Google...\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 60,\n    columnNumber: 5\n  }, this);\n}\n_s(GoogleOAuthCallback, \"0pNeyzXk/ByIxyERsdaIrG6js9s=\", false, function () {\n  return [useNavigate];\n});\n_c = GoogleOAuthCallback;\nexport default GoogleOAuthCallback;\nvar _c;\n$RefreshReg$(_c, \"GoogleOAuthCallback\");","map":{"version":3,"names":["React","useNavigate","jwtDecode","jsxDEV","_jsxDEV","GoogleOAuthCallback","_s","navigate","useEffect","handleOAuthCallback","params","URLSearchParams","window","location","search","token","get","localStorage","setItem","payload","JSON","stringify","email","role","name","console","error","style","textAlign","marginTop","children","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["E:/BackupFit/frontend/src/pages/GoogleOAuthCallback.js"],"sourcesContent":["import React from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { jwtDecode } from '../utils/jwtDecode';\r\n\r\nfunction GoogleOAuthCallback() {\r\n  const navigate = useNavigate();\r\n\r\n  React.useEffect(() => {\r\n    const handleOAuthCallback = () => {\r\n      try {\r\n        const params = new URLSearchParams(window.location.search);\r\n        const token = params.get('token');\r\n        \r\n        if (token) {\r\n          // เก็บ token\r\n          localStorage.setItem('token', token);\r\n          \r\n          // decode JWT\r\n          const payload = jwtDecode(token);\r\n          if (payload) {\r\n            // เก็บข้อมูล user\r\n            localStorage.setItem('user', JSON.stringify({\r\n              email: payload.email,\r\n              role: payload.role,\r\n              name: payload.name || '',\r\n            }));\r\n            \r\n            // redirect ตาม role\r\n            switch (payload.role) {\r\n              case 'trainee':\r\n                navigate('/trainee');\r\n                break;\r\n              case 'trainer':\r\n                navigate('/trainer');\r\n                break;\r\n              case 'admin':\r\n                navigate('/admin');\r\n                break;\r\n              default:\r\n                navigate('/home');\r\n            }\r\n          } else {\r\n            console.error('Invalid token payload');\r\n            navigate('/home');\r\n          }\r\n        } else {\r\n          console.error('No token found in URL');\r\n          navigate('/login');\r\n        }\r\n      } catch (error) {\r\n        console.error('Error processing OAuth callback:', error);\r\n        navigate('/login');\r\n      }\r\n    };\r\n\r\n    handleOAuthCallback();\r\n  }, [navigate]);\r\n\r\n  return (\r\n    <div style={{textAlign: 'center', marginTop: '50px'}}>\r\n      กำลังเข้าสู่ระบบด้วย Google...\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default GoogleOAuthCallback;"],"mappings":";;AAAA,OAAOA,KAAK,MAAM,OAAO;AACzB,SAASC,WAAW,QAAQ,kBAAkB;AAC9C,SAASC,SAAS,QAAQ,oBAAoB;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAE/C,SAASC,mBAAmBA,CAAA,EAAG;EAAAC,EAAA;EAC7B,MAAMC,QAAQ,GAAGN,WAAW,CAAC,CAAC;EAE9BD,KAAK,CAACQ,SAAS,CAAC,MAAM;IACpB,MAAMC,mBAAmB,GAAGA,CAAA,KAAM;MAChC,IAAI;QACF,MAAMC,MAAM,GAAG,IAAIC,eAAe,CAACC,MAAM,CAACC,QAAQ,CAACC,MAAM,CAAC;QAC1D,MAAMC,KAAK,GAAGL,MAAM,CAACM,GAAG,CAAC,OAAO,CAAC;QAEjC,IAAID,KAAK,EAAE;UACT;UACAE,YAAY,CAACC,OAAO,CAAC,OAAO,EAAEH,KAAK,CAAC;;UAEpC;UACA,MAAMI,OAAO,GAAGjB,SAAS,CAACa,KAAK,CAAC;UAChC,IAAII,OAAO,EAAE;YACX;YACAF,YAAY,CAACC,OAAO,CAAC,MAAM,EAAEE,IAAI,CAACC,SAAS,CAAC;cAC1CC,KAAK,EAAEH,OAAO,CAACG,KAAK;cACpBC,IAAI,EAAEJ,OAAO,CAACI,IAAI;cAClBC,IAAI,EAAEL,OAAO,CAACK,IAAI,IAAI;YACxB,CAAC,CAAC,CAAC;;YAEH;YACA,QAAQL,OAAO,CAACI,IAAI;cAClB,KAAK,SAAS;gBACZhB,QAAQ,CAAC,UAAU,CAAC;gBACpB;cACF,KAAK,SAAS;gBACZA,QAAQ,CAAC,UAAU,CAAC;gBACpB;cACF,KAAK,OAAO;gBACVA,QAAQ,CAAC,QAAQ,CAAC;gBAClB;cACF;gBACEA,QAAQ,CAAC,OAAO,CAAC;YACrB;UACF,CAAC,MAAM;YACLkB,OAAO,CAACC,KAAK,CAAC,uBAAuB,CAAC;YACtCnB,QAAQ,CAAC,OAAO,CAAC;UACnB;QACF,CAAC,MAAM;UACLkB,OAAO,CAACC,KAAK,CAAC,uBAAuB,CAAC;UACtCnB,QAAQ,CAAC,QAAQ,CAAC;QACpB;MACF,CAAC,CAAC,OAAOmB,KAAK,EAAE;QACdD,OAAO,CAACC,KAAK,CAAC,kCAAkC,EAAEA,KAAK,CAAC;QACxDnB,QAAQ,CAAC,QAAQ,CAAC;MACpB;IACF,CAAC;IAEDE,mBAAmB,CAAC,CAAC;EACvB,CAAC,EAAE,CAACF,QAAQ,CAAC,CAAC;EAEd,oBACEH,OAAA;IAAKuB,KAAK,EAAE;MAACC,SAAS,EAAE,QAAQ;MAAEC,SAAS,EAAE;IAAM,CAAE;IAAAC,QAAA,EAAC;EAEtD;IAAAC,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OAAK,CAAC;AAEV;AAAC5B,EAAA,CA3DQD,mBAAmB;EAAA,QACTJ,WAAW;AAAA;AAAAkC,EAAA,GADrB9B,mBAAmB;AA6D5B,eAAeA,mBAAmB;AAAC,IAAA8B,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}