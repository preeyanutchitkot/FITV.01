{"ast":null,"code":"// RealTimePoseService.js - Service for real-time pose comparison without backend keypoints storage\nimport { Pose } from '@mediapipe/pose';\nclass RealTimePoseService {\n  constructor() {\n    this.trainerPose = null;\n    this.traineePose = null;\n    this.isInitialized = false;\n  }\n\n  // Initialize MediaPipe Pose instances\n  async initialize() {\n    try {\n      // Initialize trainer pose detection\n      this.trainerPose = new Pose({\n        locateFile: file => {\n          return `https://cdn.jsdelivr.net/npm/@mediapipe/pose/${file}`;\n        }\n      });\n      this.trainerPose.setOptions({\n        modelComplexity: 1,\n        smoothLandmarks: true,\n        enableSegmentation: false,\n        minDetectionConfidence: 0.7,\n        minTrackingConfidence: 0.5\n      });\n\n      // Initialize trainee pose detection\n      this.traineePose = new Pose({\n        locateFile: file => {\n          return `https://cdn.jsdelivr.net/npm/@mediapipe/pose/${file}`;\n        }\n      });\n      this.traineePose.setOptions({\n        modelComplexity: 1,\n        smoothLandmarks: true,\n        enableSegmentation: false,\n        minDetectionConfidence: 0.7,\n        minTrackingConfidence: 0.5\n      });\n      await Promise.all([this.trainerPose.initialize(), this.traineePose.initialize()]);\n      this.isInitialized = true;\n      console.log('‚úÖ Real-time pose service initialized');\n      return true;\n    } catch (error) {\n      console.error('‚ùå Failed to initialize pose service:', error);\n      throw error;\n    }\n  }\n\n  // Process trainer video frame\n  async processTrainerFrame(videoElement, onResults) {\n    if (!this.isInitialized || !this.trainerPose) {\n      throw new Error('Pose service not initialized');\n    }\n    this.trainerPose.onResults(onResults);\n    await this.trainerPose.send({\n      image: videoElement\n    });\n  }\n\n  // Process trainee camera frame\n  async processTraineeFrame(videoElement, onResults) {\n    if (!this.isInitialized || !this.traineePose) {\n      throw new Error('Pose service not initialized');\n    }\n    this.traineePose.onResults(onResults);\n    await this.traineePose.send({\n      image: videoElement\n    });\n  }\n\n  // Compare two pose keypoints arrays\n  comparePoses(trainerKeypoints, traineeKeypoints) {\n    if (!trainerKeypoints || !traineeKeypoints) {\n      return {\n        similarity: 0,\n        detailedScores: {},\n        feedback: 'No pose detected',\n        recommendations: []\n      };\n    }\n    if (trainerKeypoints.length !== traineeKeypoints.length) {\n      return {\n        similarity: 0,\n        detailedScores: {},\n        feedback: 'Invalid pose data',\n        recommendations: []\n      };\n    }\n\n    // Calculate overall similarity\n    const similarity = this.calculateOverallSimilarity(trainerKeypoints, traineeKeypoints);\n\n    // Calculate detailed scores for body parts\n    const detailedScores = this.calculateDetailedScores(trainerKeypoints, traineeKeypoints);\n\n    // Generate feedback and recommendations\n    const feedback = this.generateFeedback(similarity, detailedScores);\n    const recommendations = this.generateRecommendations(detailedScores);\n    return {\n      similarity: Math.round(similarity * 100) / 100,\n      detailedScores,\n      feedback,\n      recommendations,\n      timestamp: Date.now()\n    };\n  }\n\n  // Calculate overall pose similarity\n  calculateOverallSimilarity(trainerPose, traineePose) {\n    let totalSimilarity = 0;\n    let totalWeight = 0;\n    for (let i = 0; i < trainerPose.length; i++) {\n      const trainerPoint = trainerPose[i];\n      const traineePoint = traineePose[i];\n\n      // Skip low visibility points\n      if (trainerPoint.visibility < 0.5 || traineePoint.visibility < 0.5) {\n        continue;\n      }\n\n      // Calculate 3D distance\n      const dx = trainerPoint.x - traineePoint.x;\n      const dy = trainerPoint.y - traineePoint.y;\n      const dz = trainerPoint.z - traineePoint.z;\n      const distance = Math.sqrt(dx * dx + dy * dy + dz * dz);\n\n      // Convert distance to similarity (0-1)\n      const similarity = Math.max(0, 1 - distance * 2);\n\n      // Apply joint-specific weight\n      const weight = this.getJointWeight(i);\n      totalSimilarity += similarity * weight;\n      totalWeight += weight;\n    }\n    return totalWeight > 0 ? totalSimilarity / totalWeight : 0;\n  }\n\n  // Calculate detailed scores for different body parts\n  calculateDetailedScores(trainerPose, traineePose) {\n    const bodyParts = {\n      head: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10],\n      leftArm: [11, 13, 15, 17, 19, 21],\n      rightArm: [12, 14, 16, 18, 20, 22],\n      torso: [11, 12, 23, 24],\n      leftLeg: [23, 25, 27, 29, 31],\n      rightLeg: [24, 26, 28, 30, 32]\n    };\n    const scores = {};\n    for (const [partName, indices] of Object.entries(bodyParts)) {\n      let partScore = 0;\n      let validPoints = 0;\n      for (const idx of indices) {\n        if (idx >= trainerPose.length || idx >= traineePose.length) continue;\n        const trainerPoint = trainerPose[idx];\n        const traineePoint = traineePose[idx];\n        if (trainerPoint.visibility > 0.5 && traineePoint.visibility > 0.5) {\n          const dx = trainerPoint.x - traineePoint.x;\n          const dy = trainerPoint.y - traineePoint.y;\n          const dz = trainerPoint.z - traineePoint.z;\n          const distance = Math.sqrt(dx * dx + dy * dy + dz * dz);\n          const similarity = Math.max(0, 1 - distance * 2);\n          partScore += similarity;\n          validPoints += 1;\n        }\n      }\n      scores[partName] = validPoints > 0 ? partScore / validPoints : 0;\n    }\n    return scores;\n  }\n\n  // Get weight for specific joint (important joints have higher weights)\n  getJointWeight(jointIndex) {\n    // MediaPipe pose landmark indices with weights\n    const jointWeights = {\n      0: 0.5,\n      // Nose\n      1: 0.3,\n      2: 0.3,\n      3: 0.3,\n      4: 0.3,\n      5: 0.3,\n      6: 0.3,\n      // Face points\n      7: 0.3,\n      8: 0.3,\n      9: 0.3,\n      10: 0.3,\n      11: 1.8,\n      // Left shoulder\n      12: 1.8,\n      // Right shoulder\n      13: 1.5,\n      // Left elbow\n      14: 1.5,\n      // Right elbow\n      15: 1.2,\n      // Left wrist\n      16: 1.2,\n      // Right wrist\n      17: 0.8,\n      18: 0.8,\n      // Left hand\n      19: 0.8,\n      20: 0.8,\n      21: 0.8,\n      22: 0.8,\n      // Right hand\n      23: 1.8,\n      // Left hip\n      24: 1.8,\n      // Right hip\n      25: 1.5,\n      // Left knee\n      26: 1.5,\n      // Right knee\n      27: 1.2,\n      // Left ankle\n      28: 1.2,\n      // Right ankle\n      29: 0.8,\n      30: 0.8,\n      // Left foot\n      31: 0.8,\n      32: 0.8 // Right foot\n    };\n    return jointWeights[jointIndex] || 1.0;\n  }\n\n  // Generate human-readable feedback\n  generateFeedback(similarity, detailedScores) {\n    if (similarity >= 0.95) {\n      return 'üåü Perfect form! Outstanding!';\n    } else if (similarity >= 0.85) {\n      return 'üéØ Excellent form! Keep it up!';\n    } else if (similarity >= 0.75) {\n      return 'üëç Great job! Very good form.';\n    } else if (similarity >= 0.65) {\n      return 'üëå Good form. Minor adjustments needed.';\n    } else if (similarity >= 0.50) {\n      return '‚ö†Ô∏è Form needs improvement. Focus on alignment.';\n    } else if (similarity >= 0.30) {\n      return '‚ö° Significant adjustments needed. Watch the trainer carefully.';\n    } else {\n      return 'üî¥ Major form corrections required. Follow the trainer closely.';\n    }\n  }\n\n  // Generate specific recommendations based on detailed scores\n  generateRecommendations(detailedScores) {\n    const recommendations = [];\n    const threshold = 0.6;\n    for (const [bodyPart, score] of Object.entries(detailedScores)) {\n      if (score < threshold) {\n        switch (bodyPart) {\n          case 'head':\n            recommendations.push({\n              part: 'Head',\n              message: 'Keep your head aligned and look forward',\n              icon: 'üëÄ',\n              priority: 'low'\n            });\n            break;\n          case 'leftArm':\n            recommendations.push({\n              part: 'Left Arm',\n              message: 'Adjust your left arm position to match the trainer',\n              icon: 'üí™',\n              priority: 'high'\n            });\n            break;\n          case 'rightArm':\n            recommendations.push({\n              part: 'Right Arm',\n              message: 'Adjust your right arm position to match the trainer',\n              icon: 'üí™',\n              priority: 'high'\n            });\n            break;\n          case 'torso':\n            recommendations.push({\n              part: 'Torso',\n              message: 'Keep your torso straight and aligned',\n              icon: 'üèÉ',\n              priority: 'high'\n            });\n            break;\n          case 'leftLeg':\n            recommendations.push({\n              part: 'Left Leg',\n              message: 'Check your left leg position and alignment',\n              icon: 'ü¶µ',\n              priority: 'medium'\n            });\n            break;\n          case 'rightLeg':\n            recommendations.push({\n              part: 'Right Leg',\n              message: 'Check your right leg position and alignment',\n              icon: 'ü¶µ',\n              priority: 'medium'\n            });\n            break;\n        }\n      }\n    }\n\n    // Sort by priority\n    const priorityOrder = {\n      high: 3,\n      medium: 2,\n      low: 1\n    };\n    recommendations.sort((a, b) => priorityOrder[b.priority] - priorityOrder[a.priority]);\n    return recommendations;\n  }\n\n  // Convert MediaPipe landmarks to our keypoints format\n  landmarksToKeypoints(landmarks) {\n    return landmarks.map(landmark => ({\n      x: landmark.x,\n      y: landmark.y,\n      z: landmark.z,\n      visibility: landmark.visibility\n    }));\n  }\n\n  // Get body part landmarks\n  getBodyPartLandmarks(landmarks, bodyPart) {\n    const bodyParts = {\n      head: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10],\n      leftArm: [11, 13, 15, 17, 19, 21],\n      rightArm: [12, 14, 16, 18, 20, 22],\n      torso: [11, 12, 23, 24],\n      leftLeg: [23, 25, 27, 29, 31],\n      rightLeg: [24, 26, 28, 30, 32]\n    };\n    const indices = bodyParts[bodyPart] || [];\n    return indices.map(idx => landmarks[idx]).filter(Boolean);\n  }\n\n  // Calculate angle between three points (useful for specific pose analysis)\n  calculateAngle(pointA, pointB, pointC) {\n    const vectorBA = {\n      x: pointA.x - pointB.x,\n      y: pointA.y - pointB.y\n    };\n    const vectorBC = {\n      x: pointC.x - pointB.x,\n      y: pointC.y - pointB.y\n    };\n    const dotProduct = vectorBA.x * vectorBC.x + vectorBA.y * vectorBC.y;\n    const magnitudeBA = Math.sqrt(vectorBA.x * vectorBA.x + vectorBA.y * vectorBA.y);\n    const magnitudeBC = Math.sqrt(vectorBC.x * vectorBC.x + vectorBC.y * vectorBC.y);\n    const cosineAngle = dotProduct / (magnitudeBA * magnitudeBC);\n    const angleRadians = Math.acos(Math.max(-1, Math.min(1, cosineAngle)));\n    return angleRadians * (180 / Math.PI);\n  }\n\n  // Draw pose skeleton on canvas\n  drawPose(ctx, landmarks, width, height) {\n    if (!landmarks || landmarks.length === 0) return;\n\n    // Draw connections\n    const connections = [\n    // Face\n    [0, 1], [1, 2], [2, 3], [3, 7], [0, 4], [4, 5], [5, 6], [6, 8],\n    // Arms\n    [9, 10], [11, 12], [11, 13], [13, 15], [15, 17], [15, 19], [15, 21], [12, 14], [14, 16], [16, 18], [16, 20], [16, 22],\n    // Body\n    [11, 23], [12, 24], [23, 24],\n    // Legs\n    [23, 25], [25, 27], [27, 29], [27, 31], [24, 26], [26, 28], [28, 30], [28, 32]];\n\n    // Draw connections\n    ctx.strokeStyle = '#00ff00';\n    ctx.lineWidth = 2;\n    connections.forEach(([start, end]) => {\n      if (landmarks[start] && landmarks[end] && landmarks[start].visibility > 0.5 && landmarks[end].visibility > 0.5) {\n        ctx.beginPath();\n        ctx.moveTo(landmarks[start].x * width, landmarks[start].y * height);\n        ctx.lineTo(landmarks[end].x * width, landmarks[end].y * height);\n        ctx.stroke();\n      }\n    });\n\n    // Draw landmarks\n    ctx.fillStyle = '#ff0000';\n    landmarks.forEach((landmark, index) => {\n      if (landmark.visibility > 0.5) {\n        ctx.beginPath();\n        ctx.arc(landmark.x * width, landmark.y * height, 4, 0, 2 * Math.PI);\n        ctx.fill();\n      }\n    });\n  }\n\n  // Detect pose from video element\n  async detectPose(videoElement) {\n    if (!this.isInitialized || !this.trainerPose) {\n      throw new Error('Pose service not initialized');\n    }\n    return new Promise(resolve => {\n      this.trainerPose.onResults(results => {\n        resolve(results);\n      });\n      this.trainerPose.send({\n        image: videoElement\n      });\n    });\n  }\n\n  // Cleanup resources\n  cleanup() {\n    if (this.trainerPose) {\n      this.trainerPose.close();\n      this.trainerPose = null;\n    }\n    if (this.traineePose) {\n      this.traineePose.close();\n      this.traineePose = null;\n    }\n    this.isInitialized = false;\n    console.log('üßπ Real-time pose service cleaned up');\n  }\n}\n\n// Export singleton instance\nexport default new RealTimePoseService();","map":{"version":3,"names":["Pose","RealTimePoseService","constructor","trainerPose","traineePose","isInitialized","initialize","locateFile","file","setOptions","modelComplexity","smoothLandmarks","enableSegmentation","minDetectionConfidence","minTrackingConfidence","Promise","all","console","log","error","processTrainerFrame","videoElement","onResults","Error","send","image","processTraineeFrame","comparePoses","trainerKeypoints","traineeKeypoints","similarity","detailedScores","feedback","recommendations","length","calculateOverallSimilarity","calculateDetailedScores","generateFeedback","generateRecommendations","Math","round","timestamp","Date","now","totalSimilarity","totalWeight","i","trainerPoint","traineePoint","visibility","dx","x","dy","y","dz","z","distance","sqrt","max","weight","getJointWeight","bodyParts","head","leftArm","rightArm","torso","leftLeg","rightLeg","scores","partName","indices","Object","entries","partScore","validPoints","idx","jointIndex","jointWeights","threshold","bodyPart","score","push","part","message","icon","priority","priorityOrder","high","medium","low","sort","a","b","landmarksToKeypoints","landmarks","map","landmark","getBodyPartLandmarks","filter","Boolean","calculateAngle","pointA","pointB","pointC","vectorBA","vectorBC","dotProduct","magnitudeBA","magnitudeBC","cosineAngle","angleRadians","acos","min","PI","drawPose","ctx","width","height","connections","strokeStyle","lineWidth","forEach","start","end","beginPath","moveTo","lineTo","stroke","fillStyle","index","arc","fill","detectPose","resolve","results","cleanup","close"],"sources":["C:/Fit/frontend/src/services/RealTimePoseService.js"],"sourcesContent":["// RealTimePoseService.js - Service for real-time pose comparison without backend keypoints storage\r\nimport { Pose } from '@mediapipe/pose';\r\n\r\nclass RealTimePoseService {\r\n    constructor() {\r\n        this.trainerPose = null;\r\n        this.traineePose = null;\r\n        this.isInitialized = false;\r\n    }\r\n\r\n    // Initialize MediaPipe Pose instances\r\n    async initialize() {\r\n        try {\r\n            // Initialize trainer pose detection\r\n            this.trainerPose = new Pose({\r\n                locateFile: (file) => {\r\n                    return `https://cdn.jsdelivr.net/npm/@mediapipe/pose/${file}`;\r\n                }\r\n            });\r\n\r\n            this.trainerPose.setOptions({\r\n                modelComplexity: 1,\r\n                smoothLandmarks: true,\r\n                enableSegmentation: false,\r\n                minDetectionConfidence: 0.7,\r\n                minTrackingConfidence: 0.5\r\n            });\r\n\r\n            // Initialize trainee pose detection\r\n            this.traineePose = new Pose({\r\n                locateFile: (file) => {\r\n                    return `https://cdn.jsdelivr.net/npm/@mediapipe/pose/${file}`;\r\n                }\r\n            });\r\n\r\n            this.traineePose.setOptions({\r\n                modelComplexity: 1,\r\n                smoothLandmarks: true,\r\n                enableSegmentation: false,\r\n                minDetectionConfidence: 0.7,\r\n                minTrackingConfidence: 0.5\r\n            });\r\n\r\n            await Promise.all([\r\n                this.trainerPose.initialize(),\r\n                this.traineePose.initialize()\r\n            ]);\r\n\r\n            this.isInitialized = true;\r\n            console.log('‚úÖ Real-time pose service initialized');\r\n            return true;\r\n        } catch (error) {\r\n            console.error('‚ùå Failed to initialize pose service:', error);\r\n            throw error;\r\n        }\r\n    }\r\n\r\n    // Process trainer video frame\r\n    async processTrainerFrame(videoElement, onResults) {\r\n        if (!this.isInitialized || !this.trainerPose) {\r\n            throw new Error('Pose service not initialized');\r\n        }\r\n\r\n        this.trainerPose.onResults(onResults);\r\n        await this.trainerPose.send({ image: videoElement });\r\n    }\r\n\r\n    // Process trainee camera frame\r\n    async processTraineeFrame(videoElement, onResults) {\r\n        if (!this.isInitialized || !this.traineePose) {\r\n            throw new Error('Pose service not initialized');\r\n        }\r\n\r\n        this.traineePose.onResults(onResults);\r\n        await this.traineePose.send({ image: videoElement });\r\n    }\r\n\r\n    // Compare two pose keypoints arrays\r\n    comparePoses(trainerKeypoints, traineeKeypoints) {\r\n        if (!trainerKeypoints || !traineeKeypoints) {\r\n            return {\r\n                similarity: 0,\r\n                detailedScores: {},\r\n                feedback: 'No pose detected',\r\n                recommendations: []\r\n            };\r\n        }\r\n\r\n        if (trainerKeypoints.length !== traineeKeypoints.length) {\r\n            return {\r\n                similarity: 0,\r\n                detailedScores: {},\r\n                feedback: 'Invalid pose data',\r\n                recommendations: []\r\n            };\r\n        }\r\n\r\n        // Calculate overall similarity\r\n        const similarity = this.calculateOverallSimilarity(trainerKeypoints, traineeKeypoints);\r\n        \r\n        // Calculate detailed scores for body parts\r\n        const detailedScores = this.calculateDetailedScores(trainerKeypoints, traineeKeypoints);\r\n        \r\n        // Generate feedback and recommendations\r\n        const feedback = this.generateFeedback(similarity, detailedScores);\r\n        const recommendations = this.generateRecommendations(detailedScores);\r\n\r\n        return {\r\n            similarity: Math.round(similarity * 100) / 100,\r\n            detailedScores,\r\n            feedback,\r\n            recommendations,\r\n            timestamp: Date.now()\r\n        };\r\n    }\r\n\r\n    // Calculate overall pose similarity\r\n    calculateOverallSimilarity(trainerPose, traineePose) {\r\n        let totalSimilarity = 0;\r\n        let totalWeight = 0;\r\n\r\n        for (let i = 0; i < trainerPose.length; i++) {\r\n            const trainerPoint = trainerPose[i];\r\n            const traineePoint = traineePose[i];\r\n\r\n            // Skip low visibility points\r\n            if (trainerPoint.visibility < 0.5 || traineePoint.visibility < 0.5) {\r\n                continue;\r\n            }\r\n\r\n            // Calculate 3D distance\r\n            const dx = trainerPoint.x - traineePoint.x;\r\n            const dy = trainerPoint.y - traineePoint.y;\r\n            const dz = trainerPoint.z - traineePoint.z;\r\n            const distance = Math.sqrt(dx * dx + dy * dy + dz * dz);\r\n\r\n            // Convert distance to similarity (0-1)\r\n            const similarity = Math.max(0, 1 - distance * 2);\r\n\r\n            // Apply joint-specific weight\r\n            const weight = this.getJointWeight(i);\r\n            totalSimilarity += similarity * weight;\r\n            totalWeight += weight;\r\n        }\r\n\r\n        return totalWeight > 0 ? totalSimilarity / totalWeight : 0;\r\n    }\r\n\r\n    // Calculate detailed scores for different body parts\r\n    calculateDetailedScores(trainerPose, traineePose) {\r\n        const bodyParts = {\r\n            head: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10],\r\n            leftArm: [11, 13, 15, 17, 19, 21],\r\n            rightArm: [12, 14, 16, 18, 20, 22],\r\n            torso: [11, 12, 23, 24],\r\n            leftLeg: [23, 25, 27, 29, 31],\r\n            rightLeg: [24, 26, 28, 30, 32]\r\n        };\r\n\r\n        const scores = {};\r\n\r\n        for (const [partName, indices] of Object.entries(bodyParts)) {\r\n            let partScore = 0;\r\n            let validPoints = 0;\r\n\r\n            for (const idx of indices) {\r\n                if (idx >= trainerPose.length || idx >= traineePose.length) continue;\r\n\r\n                const trainerPoint = trainerPose[idx];\r\n                const traineePoint = traineePose[idx];\r\n\r\n                if (trainerPoint.visibility > 0.5 && traineePoint.visibility > 0.5) {\r\n                    const dx = trainerPoint.x - traineePoint.x;\r\n                    const dy = trainerPoint.y - traineePoint.y;\r\n                    const dz = trainerPoint.z - traineePoint.z;\r\n                    const distance = Math.sqrt(dx * dx + dy * dy + dz * dz);\r\n                    \r\n                    const similarity = Math.max(0, 1 - distance * 2);\r\n                    partScore += similarity;\r\n                    validPoints += 1;\r\n                }\r\n            }\r\n\r\n            scores[partName] = validPoints > 0 ? partScore / validPoints : 0;\r\n        }\r\n\r\n        return scores;\r\n    }\r\n\r\n    // Get weight for specific joint (important joints have higher weights)\r\n    getJointWeight(jointIndex) {\r\n        // MediaPipe pose landmark indices with weights\r\n        const jointWeights = {\r\n            0: 0.5,   // Nose\r\n            1: 0.3, 2: 0.3, 3: 0.3, 4: 0.3, 5: 0.3, 6: 0.3, // Face points\r\n            7: 0.3, 8: 0.3, 9: 0.3, 10: 0.3,\r\n            11: 1.8,  // Left shoulder\r\n            12: 1.8,  // Right shoulder\r\n            13: 1.5,  // Left elbow\r\n            14: 1.5,  // Right elbow\r\n            15: 1.2,  // Left wrist\r\n            16: 1.2,  // Right wrist\r\n            17: 0.8, 18: 0.8, // Left hand\r\n            19: 0.8, 20: 0.8, 21: 0.8, 22: 0.8, // Right hand\r\n            23: 1.8,  // Left hip\r\n            24: 1.8,  // Right hip\r\n            25: 1.5,  // Left knee\r\n            26: 1.5,  // Right knee\r\n            27: 1.2,  // Left ankle\r\n            28: 1.2,  // Right ankle\r\n            29: 0.8, 30: 0.8, // Left foot\r\n            31: 0.8, 32: 0.8  // Right foot\r\n        };\r\n\r\n        return jointWeights[jointIndex] || 1.0;\r\n    }\r\n\r\n    // Generate human-readable feedback\r\n    generateFeedback(similarity, detailedScores) {\r\n        if (similarity >= 0.95) {\r\n            return 'üåü Perfect form! Outstanding!';\r\n        } else if (similarity >= 0.85) {\r\n            return 'üéØ Excellent form! Keep it up!';\r\n        } else if (similarity >= 0.75) {\r\n            return 'üëç Great job! Very good form.';\r\n        } else if (similarity >= 0.65) {\r\n            return 'üëå Good form. Minor adjustments needed.';\r\n        } else if (similarity >= 0.50) {\r\n            return '‚ö†Ô∏è Form needs improvement. Focus on alignment.';\r\n        } else if (similarity >= 0.30) {\r\n            return '‚ö° Significant adjustments needed. Watch the trainer carefully.';\r\n        } else {\r\n            return 'üî¥ Major form corrections required. Follow the trainer closely.';\r\n        }\r\n    }\r\n\r\n    // Generate specific recommendations based on detailed scores\r\n    generateRecommendations(detailedScores) {\r\n        const recommendations = [];\r\n        const threshold = 0.6;\r\n\r\n        for (const [bodyPart, score] of Object.entries(detailedScores)) {\r\n            if (score < threshold) {\r\n                switch (bodyPart) {\r\n                    case 'head':\r\n                        recommendations.push({\r\n                            part: 'Head',\r\n                            message: 'Keep your head aligned and look forward',\r\n                            icon: 'üëÄ',\r\n                            priority: 'low'\r\n                        });\r\n                        break;\r\n                    case 'leftArm':\r\n                        recommendations.push({\r\n                            part: 'Left Arm',\r\n                            message: 'Adjust your left arm position to match the trainer',\r\n                            icon: 'üí™',\r\n                            priority: 'high'\r\n                        });\r\n                        break;\r\n                    case 'rightArm':\r\n                        recommendations.push({\r\n                            part: 'Right Arm',\r\n                            message: 'Adjust your right arm position to match the trainer',\r\n                            icon: 'üí™',\r\n                            priority: 'high'\r\n                        });\r\n                        break;\r\n                    case 'torso':\r\n                        recommendations.push({\r\n                            part: 'Torso',\r\n                            message: 'Keep your torso straight and aligned',\r\n                            icon: 'üèÉ',\r\n                            priority: 'high'\r\n                        });\r\n                        break;\r\n                    case 'leftLeg':\r\n                        recommendations.push({\r\n                            part: 'Left Leg',\r\n                            message: 'Check your left leg position and alignment',\r\n                            icon: 'ü¶µ',\r\n                            priority: 'medium'\r\n                        });\r\n                        break;\r\n                    case 'rightLeg':\r\n                        recommendations.push({\r\n                            part: 'Right Leg',\r\n                            message: 'Check your right leg position and alignment',\r\n                            icon: 'ü¶µ',\r\n                            priority: 'medium'\r\n                        });\r\n                        break;\r\n                }\r\n            }\r\n        }\r\n\r\n        // Sort by priority\r\n        const priorityOrder = { high: 3, medium: 2, low: 1 };\r\n        recommendations.sort((a, b) => priorityOrder[b.priority] - priorityOrder[a.priority]);\r\n\r\n        return recommendations;\r\n    }\r\n\r\n    // Convert MediaPipe landmarks to our keypoints format\r\n    landmarksToKeypoints(landmarks) {\r\n        return landmarks.map(landmark => ({\r\n            x: landmark.x,\r\n            y: landmark.y,\r\n            z: landmark.z,\r\n            visibility: landmark.visibility\r\n        }));\r\n    }\r\n\r\n    // Get body part landmarks\r\n    getBodyPartLandmarks(landmarks, bodyPart) {\r\n        const bodyParts = {\r\n            head: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10],\r\n            leftArm: [11, 13, 15, 17, 19, 21],\r\n            rightArm: [12, 14, 16, 18, 20, 22],\r\n            torso: [11, 12, 23, 24],\r\n            leftLeg: [23, 25, 27, 29, 31],\r\n            rightLeg: [24, 26, 28, 30, 32]\r\n        };\r\n\r\n        const indices = bodyParts[bodyPart] || [];\r\n        return indices.map(idx => landmarks[idx]).filter(Boolean);\r\n    }\r\n\r\n    // Calculate angle between three points (useful for specific pose analysis)\r\n    calculateAngle(pointA, pointB, pointC) {\r\n        const vectorBA = {\r\n            x: pointA.x - pointB.x,\r\n            y: pointA.y - pointB.y\r\n        };\r\n        \r\n        const vectorBC = {\r\n            x: pointC.x - pointB.x,\r\n            y: pointC.y - pointB.y\r\n        };\r\n\r\n        const dotProduct = vectorBA.x * vectorBC.x + vectorBA.y * vectorBC.y;\r\n        const magnitudeBA = Math.sqrt(vectorBA.x * vectorBA.x + vectorBA.y * vectorBA.y);\r\n        const magnitudeBC = Math.sqrt(vectorBC.x * vectorBC.x + vectorBC.y * vectorBC.y);\r\n\r\n        const cosineAngle = dotProduct / (magnitudeBA * magnitudeBC);\r\n        const angleRadians = Math.acos(Math.max(-1, Math.min(1, cosineAngle)));\r\n        \r\n        return angleRadians * (180 / Math.PI);\r\n    }\r\n\r\n    // Draw pose skeleton on canvas\r\n    drawPose(ctx, landmarks, width, height) {\r\n        if (!landmarks || landmarks.length === 0) return;\r\n\r\n        // Draw connections\r\n        const connections = [\r\n            // Face\r\n            [0, 1], [1, 2], [2, 3], [3, 7], [0, 4], [4, 5], [5, 6], [6, 8],\r\n            // Arms\r\n            [9, 10], [11, 12], [11, 13], [13, 15], [15, 17], [15, 19], [15, 21],\r\n            [12, 14], [14, 16], [16, 18], [16, 20], [16, 22],\r\n            // Body\r\n            [11, 23], [12, 24], [23, 24],\r\n            // Legs\r\n            [23, 25], [25, 27], [27, 29], [27, 31], [24, 26], [26, 28], [28, 30], [28, 32]\r\n        ];\r\n\r\n        // Draw connections\r\n        ctx.strokeStyle = '#00ff00';\r\n        ctx.lineWidth = 2;\r\n        connections.forEach(([start, end]) => {\r\n            if (landmarks[start] && landmarks[end] && \r\n                landmarks[start].visibility > 0.5 && landmarks[end].visibility > 0.5) {\r\n                ctx.beginPath();\r\n                ctx.moveTo(landmarks[start].x * width, landmarks[start].y * height);\r\n                ctx.lineTo(landmarks[end].x * width, landmarks[end].y * height);\r\n                ctx.stroke();\r\n            }\r\n        });\r\n\r\n        // Draw landmarks\r\n        ctx.fillStyle = '#ff0000';\r\n        landmarks.forEach((landmark, index) => {\r\n            if (landmark.visibility > 0.5) {\r\n                ctx.beginPath();\r\n                ctx.arc(\r\n                    landmark.x * width,\r\n                    landmark.y * height,\r\n                    4,\r\n                    0,\r\n                    2 * Math.PI\r\n                );\r\n                ctx.fill();\r\n            }\r\n        });\r\n    }\r\n\r\n    // Detect pose from video element\r\n    async detectPose(videoElement) {\r\n        if (!this.isInitialized || !this.trainerPose) {\r\n            throw new Error('Pose service not initialized');\r\n        }\r\n\r\n        return new Promise((resolve) => {\r\n            this.trainerPose.onResults((results) => {\r\n                resolve(results);\r\n            });\r\n\r\n            this.trainerPose.send({ image: videoElement });\r\n        });\r\n    }\r\n\r\n    // Cleanup resources\r\n    cleanup() {\r\n        if (this.trainerPose) {\r\n            this.trainerPose.close();\r\n            this.trainerPose = null;\r\n        }\r\n        \r\n        if (this.traineePose) {\r\n            this.traineePose.close();\r\n            this.traineePose = null;\r\n        }\r\n        \r\n        this.isInitialized = false;\r\n        console.log('üßπ Real-time pose service cleaned up');\r\n    }\r\n}\r\n\r\n// Export singleton instance\r\nexport default new RealTimePoseService();"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}