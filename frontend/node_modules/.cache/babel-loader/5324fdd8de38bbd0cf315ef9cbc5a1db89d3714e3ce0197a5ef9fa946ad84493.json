{"ast":null,"code":"/**\r\n * üéØ Advanced Multi-Directional Pose Comparator\r\n * ‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏ó‡πà‡∏≤‡∏ó‡∏≤‡∏á‡πÅ‡∏ö‡∏ö 8 ‡∏ó‡∏¥‡∏®‡∏ó‡∏≤‡∏á ‡πÇ‡∏î‡∏¢‡πÉ‡∏ä‡πâ‡∏°‡∏∏‡∏°‡∏Ç‡πâ‡∏≠‡∏ï‡πà‡∏≠‡πÅ‡∏ó‡∏ô‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏à‡∏∏‡∏î\r\n * \r\n * Concept: \r\n * - ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏°‡∏∏‡∏°‡∏Ç‡πâ‡∏≠‡∏ï‡πà‡∏≠‡∏´‡∏•‡∏±‡∏Å‡∏à‡∏≤‡∏Å keypoints (Joint Angles)\r\n * - ‡πÅ‡∏õ‡∏•‡∏á‡πÄ‡∏õ‡πá‡∏ô 8 ‡∏ó‡∏¥‡∏®‡∏ó‡∏≤‡∏á (Front, Back, Left, Right, ‡πÅ‡∏•‡∏∞ 4 ‡πÄ‡∏â‡∏µ‡∏¢‡∏á)\r\n * - ‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö trainee ‡∏Å‡∏±‡∏ö trainer ‡πÅ‡∏ö‡∏ö real-time\r\n */\n\nexport class MultiDirectionalPoseComparator {\n  constructor() {\n    // MediaPipe Pose landmark indices\n    this.LANDMARKS = {\n      // Upper body key points\n      LEFT_SHOULDER: 11,\n      RIGHT_SHOULDER: 12,\n      LEFT_ELBOW: 13,\n      RIGHT_ELBOW: 14,\n      LEFT_WRIST: 15,\n      RIGHT_WRIST: 16,\n      LEFT_HIP: 23,\n      RIGHT_HIP: 24,\n      LEFT_KNEE: 25,\n      RIGHT_KNEE: 26,\n      LEFT_ANKLE: 27,\n      RIGHT_ANKLE: 28,\n      NOSE: 0,\n      LEFT_EAR: 7,\n      RIGHT_EAR: 8\n    };\n\n    // Joint angle definitions - ‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏°‡∏∏‡∏°‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏î‡πâ‡∏ß‡∏¢ 3 ‡∏à‡∏∏‡∏î [‡∏à‡∏∏‡∏î‡πÅ‡∏£‡∏Å, ‡∏à‡∏∏‡∏î‡∏Å‡∏∂‡πà‡∏á‡∏Å‡∏•‡∏≤‡∏á, ‡∏à‡∏∏‡∏î‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢]\n    this.JOINT_ANGLES = {\n      // ‡πÅ‡∏Ç‡∏ô‡∏ã‡πâ‡∏≤‡∏¢\n      LEFT_ARM_ANGLE: [this.LANDMARKS.LEFT_SHOULDER, this.LANDMARKS.LEFT_ELBOW, this.LANDMARKS.LEFT_WRIST],\n      // ‡πÅ‡∏Ç‡∏ô‡∏Ç‡∏ß‡∏≤  \n      RIGHT_ARM_ANGLE: [this.LANDMARKS.RIGHT_SHOULDER, this.LANDMARKS.RIGHT_ELBOW, this.LANDMARKS.RIGHT_WRIST],\n      // ‡∏Ç‡∏≤‡∏ã‡πâ‡∏≤‡∏¢\n      LEFT_LEG_ANGLE: [this.LANDMARKS.LEFT_HIP, this.LANDMARKS.LEFT_KNEE, this.LANDMARKS.LEFT_ANKLE],\n      // ‡∏Ç‡∏≤‡∏Ç‡∏ß‡∏≤\n      RIGHT_LEG_ANGLE: [this.LANDMARKS.RIGHT_HIP, this.LANDMARKS.RIGHT_KNEE, this.LANDMARKS.RIGHT_ANKLE],\n      // ‡∏•‡∏≥‡∏ï‡∏±‡∏ß‡∏ã‡πâ‡∏≤‡∏¢\n      LEFT_TORSO_ANGLE: [this.LANDMARKS.LEFT_SHOULDER, this.LANDMARKS.LEFT_HIP, this.LANDMARKS.LEFT_KNEE],\n      // ‡∏•‡∏≥‡∏ï‡∏±‡∏ß‡∏Ç‡∏ß‡∏≤\n      RIGHT_TORSO_ANGLE: [this.LANDMARKS.RIGHT_SHOULDER, this.LANDMARKS.RIGHT_HIP, this.LANDMARKS.RIGHT_KNEE],\n      // ‡πÑ‡∏´‡∏•‡πà (shoulder alignment)\n      SHOULDER_ANGLE: [this.LANDMARKS.LEFT_SHOULDER, this.LANDMARKS.NOSE, this.LANDMARKS.RIGHT_SHOULDER],\n      // ‡∏™‡∏∞‡πÇ‡∏û‡∏Å (hip alignment)  \n      HIP_ANGLE: [this.LANDMARKS.LEFT_HIP, this.LANDMARKS.NOSE, this.LANDMARKS.RIGHT_HIP]\n    };\n\n    // 8 ‡∏ó‡∏¥‡∏®‡∏ó‡∏≤‡∏á‡∏´‡∏•‡∏±‡∏Å (degrees)\n    this.DIRECTIONS = {\n      FRONT: 0,\n      // ‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡∏£‡∏á\n      FRONT_RIGHT: 45,\n      // ‡πÄ‡∏â‡∏µ‡∏¢‡∏á‡∏Ç‡∏ß‡∏≤‡∏´‡∏ô‡πâ‡∏≤\n      RIGHT: 90,\n      // ‡∏Ç‡πâ‡∏≤‡∏á‡∏Ç‡∏ß‡∏≤\n      BACK_RIGHT: 135,\n      // ‡πÄ‡∏â‡∏µ‡∏¢‡∏á‡∏Ç‡∏ß‡∏≤‡∏´‡∏•‡∏±‡∏á\n      BACK: 180,\n      // ‡∏´‡∏•‡∏±‡∏á\n      BACK_LEFT: 225,\n      // ‡πÄ‡∏â‡∏µ‡∏¢‡∏á‡∏ã‡πâ‡∏≤‡∏¢‡∏´‡∏•‡∏±‡∏á\n      LEFT: 270,\n      // ‡∏Ç‡πâ‡∏≤‡∏á‡∏ã‡πâ‡∏≤‡∏¢\n      FRONT_LEFT: 315 // ‡πÄ‡∏â‡∏µ‡∏¢‡∏á‡∏ã‡πâ‡∏≤‡∏¢‡∏´‡∏ô‡πâ‡∏≤\n    };\n\n    // ‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏Ç‡∏≠‡∏á‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏Ç‡πâ‡∏≠‡∏ï‡πà‡∏≠\n    this.JOINT_WEIGHTS = {\n      LEFT_ARM_ANGLE: 1.5,\n      RIGHT_ARM_ANGLE: 1.5,\n      LEFT_LEG_ANGLE: 2.0,\n      RIGHT_LEG_ANGLE: 2.0,\n      LEFT_TORSO_ANGLE: 2.5,\n      RIGHT_TORSO_ANGLE: 2.5,\n      SHOULDER_ANGLE: 1.8,\n      HIP_ANGLE: 1.8\n    };\n\n    // Minimum visibility threshold\n    this.MIN_VISIBILITY = 0.6;\n  }\n\n  /**\r\n   * üéØ Main comparison function - Multi-directional pose matching\r\n   * @param {Array} trainerPose - Trainer's keypoints\r\n   * @param {Array} traineePose - Trainee's keypoints (real-time)\r\n   * @returns {Object} - Comparison result with accuracy and detailed analysis\r\n   */\n  compareMultiDirectional(trainerPose, traineePose) {\n    if (!this.isValidPose(trainerPose) || !this.isValidPose(traineePose)) {\n      return this.getErrorResult(\"Invalid pose data\");\n    }\n\n    // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ trainee ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏ó‡πà‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà\n    if (!this.isActiveExercisePose(traineePose)) {\n      return {\n        accuracy: 0,\n        confidence: 0,\n        feedback: \"üö∂‚Äç‚ôÇÔ∏è ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏≥‡∏ó‡πà‡∏≤‡∏ï‡∏≤‡∏°‡∏Ñ‡∏•‡∏¥‡∏õ\",\n        jointComparisons: {},\n        trainerDirection: \"unknown\",\n        traineeDirection: \"unknown\",\n        bodyPartScores: {},\n        recommendations: [\"‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏≥‡∏ó‡πà‡∏≤‡∏≠‡∏≠‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏¢‡∏ï‡∏≤‡∏°‡∏ó‡∏µ‡πà‡πÄ‡∏´‡πá‡∏ô‡πÉ‡∏ô‡∏Ñ‡∏•‡∏¥‡∏õ\"]\n      };\n    }\n\n    // 1. ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏°‡∏∏‡∏°‡∏Ç‡πâ‡∏≠‡∏ï‡πà‡∏≠‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏Ç‡∏≠‡∏á trainer ‡πÅ‡∏•‡∏∞ trainee\n    const trainerAngles = this.calculateAllJointAngles(trainerPose);\n    const traineeAngles = this.calculateAllJointAngles(traineePose);\n\n    // 2. ‡∏£‡∏∞‡∏ö‡∏∏‡∏ó‡∏¥‡∏®‡∏ó‡∏≤‡∏á‡∏´‡∏•‡∏±‡∏Å‡∏Ç‡∏≠‡∏á‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏Ñ‡∏ô (‡πÉ‡∏ä‡πâ shoulder orientation)\n    const trainerDirection = this.detectBodyDirection(trainerPose);\n    const traineeDirection = this.detectBodyDirection(traineePose);\n\n    // 3. ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡πà‡∏≤‡∏á‡∏°‡∏∏‡∏°‡∏Ç‡πâ‡∏≠‡∏ï‡πà‡∏≠‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏ï‡∏±‡∏ß\n    const angleComparisons = this.compareJointAngles(trainerAngles, traineeAngles);\n\n    // 4. ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì accuracy ‡πÇ‡∏î‡∏¢‡∏£‡∏ß‡∏°\n    const accuracy = this.calculateWeightedAccuracy(angleComparisons);\n\n    // 5. ‡∏™‡∏£‡πâ‡∏≤‡∏á feedback ‡πÅ‡∏•‡∏∞‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥\n    const feedback = this.generateDirectionalFeedback(accuracy, angleComparisons, trainerDirection, traineeDirection);\n    return {\n      accuracy: Math.round(accuracy),\n      confidence: this.calculateConfidence(trainerAngles, traineeAngles),\n      feedback,\n      jointComparisons: angleComparisons,\n      trainerDirection,\n      traineeDirection,\n      bodyPartScores: this.calculateBodyPartScores(angleComparisons),\n      recommendations: this.generateRecommendations(angleComparisons)\n    };\n  }\n\n  /**\r\n   * üìê ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏°‡∏∏‡∏°‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏™‡∏≤‡∏°‡∏à‡∏∏‡∏î (P1-P2-P3) ‡πÇ‡∏î‡∏¢ P2 ‡πÄ‡∏õ‡πá‡∏ô‡∏à‡∏∏‡∏î‡∏Å‡∏∂‡πà‡∏á‡∏Å‡∏•‡∏≤‡∏á\r\n   */\n  calculateAngle(p1, p2, p3) {\n    if (!p1 || !p2 || !p3) return null;\n\n    // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÄ‡∏ß‡∏Å‡πÄ‡∏ï‡∏≠‡∏£‡πå\n    const v1 = {\n      x: p1.x - p2.x,\n      y: p1.y - p2.y\n    };\n    const v2 = {\n      x: p3.x - p2.x,\n      y: p3.y - p2.y\n    };\n\n    // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏°‡∏∏‡∏°‡πÇ‡∏î‡∏¢‡πÉ‡∏ä‡πâ dot product ‡πÅ‡∏•‡∏∞ cross product\n    const dot = v1.x * v2.x + v1.y * v2.y;\n    const cross = v1.x * v2.y - v1.y * v2.x;\n    let angle = Math.atan2(cross, dot) * (180 / Math.PI);\n\n    // ‡πÅ‡∏õ‡∏•‡∏á‡πÄ‡∏õ‡πá‡∏ô positive angle (0-360)\n    if (angle < 0) angle += 360;\n    return angle;\n  }\n\n  /**\r\n   * üîç ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏°‡∏∏‡∏°‡∏Ç‡πâ‡∏≠‡∏ï‡πà‡∏≠‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î\r\n   */\n  calculateAllJointAngles(pose) {\n    const angles = {};\n    Object.entries(this.JOINT_ANGLES).forEach(([jointName, [p1Idx, p2Idx, p3Idx]]) => {\n      const p1 = pose[p1Idx];\n      const p2 = pose[p2Idx];\n      const p3 = pose[p3Idx];\n\n      // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏à‡∏∏‡∏î‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏≤‡∏°‡∏°‡∏≠‡∏á‡πÄ‡∏´‡πá‡∏ô‡πÑ‡∏î‡πâ‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô\n      if (this.arePointsVisible([p1, p2, p3])) {\n        angles[jointName] = this.calculateAngle(p1, p2, p3);\n      } else {\n        angles[jointName] = null; // ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÑ‡∏î‡πâ\n      }\n    });\n    return angles;\n  }\n\n  /**\r\n   * üß≠ ‡∏ï‡∏£‡∏ß‡∏à‡∏à‡∏±‡∏ö‡∏ó‡∏¥‡∏®‡∏ó‡∏≤‡∏á‡∏£‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏¢‡∏´‡∏•‡∏±‡∏Å (‡πÉ‡∏ä‡πâ‡πÑ‡∏´‡∏•‡πà‡πÄ‡∏õ‡πá‡∏ô‡∏´‡∏•‡∏±‡∏Å)\r\n   */\n  detectBodyDirection(pose) {\n    const leftShoulder = pose[this.LANDMARKS.LEFT_SHOULDER];\n    const rightShoulder = pose[this.LANDMARKS.RIGHT_SHOULDER];\n    const nose = pose[this.LANDMARKS.NOSE];\n    if (!this.arePointsVisible([leftShoulder, rightShoulder, nose])) {\n      return 'UNKNOWN';\n    }\n\n    // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏°‡∏∏‡∏°‡πÑ‡∏´‡∏•‡πà‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏Å‡∏±‡∏ö‡πÅ‡∏ô‡∏ß‡∏ô‡∏≠‡∏ô\n    const shoulderAngle = Math.atan2(rightShoulder.y - leftShoulder.y, rightShoulder.x - leftShoulder.x) * (180 / Math.PI);\n\n    // ‡πÅ‡∏õ‡∏•‡∏á‡πÄ‡∏õ‡πá‡∏ô positive angle\n    let normalizedAngle = shoulderAngle < 0 ? shoulderAngle + 360 : shoulderAngle;\n\n    // ‡∏à‡∏±‡∏ö‡∏Ñ‡∏π‡πà‡∏Å‡∏±‡∏ö‡∏ó‡∏¥‡∏®‡∏ó‡∏≤‡∏á‡∏ó‡∏µ‡πà‡πÉ‡∏Å‡∏•‡πâ‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î\n    let closestDirection = 'FRONT';\n    let minDifference = Infinity;\n    Object.entries(this.DIRECTIONS).forEach(([direction, angle]) => {\n      const difference = Math.min(Math.abs(normalizedAngle - angle), Math.abs(normalizedAngle - angle + 360), Math.abs(normalizedAngle - angle - 360));\n      if (difference < minDifference) {\n        minDifference = difference;\n        closestDirection = direction;\n      }\n    });\n    return closestDirection;\n  }\n\n  /**\r\n   * ‚öñÔ∏è ‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏°‡∏∏‡∏°‡∏Ç‡πâ‡∏≠‡∏ï‡πà‡∏≠‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á trainer ‡πÅ‡∏•‡∏∞ trainee\r\n   */\n  compareJointAngles(trainerAngles, traineeAngles) {\n    const comparisons = {};\n    Object.keys(this.JOINT_ANGLES).forEach(jointName => {\n      const trainerAngle = trainerAngles[jointName];\n      const traineeAngle = traineeAngles[jointName];\n      if (trainerAngle !== null && traineeAngle !== null) {\n        // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡πà‡∏≤‡∏á‡∏°‡∏∏‡∏° (‡∏´‡∏≤‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏ô‡πâ‡∏≠‡∏¢‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡πÉ‡∏ô 360 ‡∏≠‡∏á‡∏®‡∏≤)\n        let angleDiff = Math.abs(trainerAngle - traineeAngle);\n        angleDiff = Math.min(angleDiff, 360 - angleDiff);\n\n        // ‡πÅ‡∏õ‡∏•‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥ (‡∏¢‡∏¥‡πà‡∏á‡∏ï‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ = ‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥‡∏°‡∏≤‡∏Å) - ‡πÄ‡∏Ç‡πâ‡∏°‡∏á‡∏ß‡∏î‡∏°‡∏≤‡∏Å‡∏Ç‡∏∂‡πâ‡∏ô\n        const accuracy = Math.max(0, 100 - angleDiff * 3.0); // ‡πÄ‡∏û‡∏¥‡πà‡∏° sensitivity factor ‡∏à‡∏≤‡∏Å 1.2 ‡πÄ‡∏õ‡πá‡∏ô 3.0\n\n        comparisons[jointName] = {\n          trainerAngle: Math.round(trainerAngle),\n          traineeAngle: Math.round(traineeAngle),\n          angleDifference: Math.round(angleDiff),\n          accuracy: Math.round(accuracy),\n          weight: this.JOINT_WEIGHTS[jointName] || 1.0\n        };\n      } else {\n        comparisons[jointName] = {\n          trainerAngle: trainerAngle,\n          traineeAngle: traineeAngle,\n          angleDifference: null,\n          accuracy: 0,\n          weight: this.JOINT_WEIGHTS[jointName] || 1.0,\n          error: 'Points not visible'\n        };\n      }\n    });\n    return comparisons;\n  }\n\n  /**\r\n   * üìä ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì accuracy ‡πÇ‡∏î‡∏¢‡∏£‡∏ß‡∏°‡πÅ‡∏ö‡∏ö‡∏°‡∏µ‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å\r\n   */\n  calculateWeightedAccuracy(angleComparisons) {\n    let totalWeightedScore = 0;\n    let totalWeight = 0;\n    let majorDifferences = 0; // ‡∏ô‡∏±‡∏ö‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ç‡πâ‡∏≠‡∏ï‡πà‡∏≠‡∏ó‡∏µ‡πà‡∏ï‡πà‡∏≤‡∏á‡∏Å‡∏±‡∏ô‡∏°‡∏≤‡∏Å\n\n    Object.values(angleComparisons).forEach(comparison => {\n      if (comparison.accuracy >= 0) {\n        totalWeightedScore += comparison.accuracy * comparison.weight;\n        totalWeight += comparison.weight;\n\n        // ‡∏ñ‡πâ‡∏≤‡∏°‡∏∏‡∏°‡∏ï‡πà‡∏≤‡∏á‡∏Å‡∏±‡∏ô‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤ 30 ‡∏≠‡∏á‡∏®‡∏≤ ‡∏ñ‡∏∑‡∏≠‡∏ß‡πà‡∏≤‡∏ó‡πà‡∏≤‡∏ú‡∏¥‡∏î‡∏°‡∏≤‡∏Å\n        if (comparison.angleDifference > 30) {\n          majorDifferences++;\n        }\n      }\n    });\n    const baseAccuracy = totalWeight > 0 ? totalWeightedScore / totalWeight : 0;\n\n    // ‡∏•‡∏á‡πÇ‡∏ó‡∏©‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡∏ó‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏ú‡∏¥‡∏î‡∏°‡∏≤‡∏Å (‡∏ï‡πà‡∏≤‡∏á‡∏Å‡∏±‡∏ô‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤ 30 ‡∏≠‡∏á‡∏®‡∏≤)\n    const penaltyFactor = Math.max(0.1, 1 - majorDifferences * 0.15); // ‡∏•‡∏î‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô 15% ‡∏ï‡πà‡∏≠‡∏ó‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏ú‡∏¥‡∏î‡∏°‡∏≤‡∏Å\n\n    return Math.max(0, baseAccuracy * penaltyFactor);\n  }\n\n  /**\r\n   * üí¨ ‡∏™‡∏£‡πâ‡∏≤‡∏á feedback ‡∏ï‡∏≤‡∏°‡∏ó‡∏¥‡∏®‡∏ó‡∏≤‡∏á\r\n   */\n  generateDirectionalFeedback(accuracy, angleComparisons, trainerDirection, traineeDirection) {\n    if (accuracy >= 90) {\n      return \"üéâ ‡∏¢‡∏≠‡∏î‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°! ‡∏ó‡πà‡∏≤‡∏≠‡∏≠‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏¢‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥‡∏°‡∏≤‡∏Å\";\n    } else if (accuracy >= 80) {\n      return \"üëç ‡∏î‡∏µ‡∏°‡∏≤‡∏Å! ‡πÄ‡∏Å‡∏∑‡∏≠‡∏ö‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå‡πÅ‡∏•‡πâ‡∏ß\";\n    } else if (accuracy >= 70) {\n      return \"‚ö° ‡πÉ‡∏Å‡∏•‡πâ‡πÄ‡∏Ñ‡∏µ‡∏¢‡∏á‡πÅ‡∏•‡πâ‡∏ß ‡∏õ‡∏£‡∏±‡∏ö‡∏ó‡πà‡∏≤‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢\";\n    } else if (accuracy >= 60) {\n      // ‡∏´‡∏≤‡∏Ç‡πâ‡∏≠‡∏ï‡πà‡∏≠‡∏ó‡∏µ‡πà‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥‡∏ô‡πâ‡∏≠‡∏¢‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î\n      const worstJoint = this.findWorstJoint(angleComparisons);\n      return `‚ö†Ô∏è ‡∏õ‡∏£‡∏±‡∏ö${this.getJointNameThai(worstJoint)}‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏á‡∏°‡∏≤‡∏Å‡∏Ç‡∏∂‡πâ‡∏ô`;\n    } else if (accuracy >= 40) {\n      return `üîÑ ‡∏•‡∏≠‡∏á‡∏´‡∏±‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡πÑ‡∏õ‡∏ó‡∏≤‡∏á${this.getDirectionThai(trainerDirection)}‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÇ‡∏Ñ‡πâ‡∏ä`;\n    } else {\n      return \"üéØ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÉ‡∏´‡∏°‡πà - ‡∏î‡∏π‡∏ó‡πà‡∏≤‡∏Ç‡∏≠‡∏á‡πÇ‡∏Ñ‡πâ‡∏ä‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î\";\n    }\n  }\n\n  /**\r\n   * üîç ‡∏´‡∏≤‡∏Ç‡πâ‡∏≠‡∏ï‡πà‡∏≠‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥‡∏ô‡πâ‡∏≠‡∏¢‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î\r\n   */\n  findWorstJoint(angleComparisons) {\n    let worstJoint = null;\n    let lowestAccuracy = 100;\n    Object.entries(angleComparisons).forEach(([jointName, comparison]) => {\n      if (comparison.accuracy < lowestAccuracy) {\n        lowestAccuracy = comparison.accuracy;\n        worstJoint = jointName;\n      }\n    });\n    return worstJoint;\n  }\n\n  /**\r\n   * üèãÔ∏è ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÅ‡∏¢‡∏Å‡∏ï‡∏≤‡∏°‡∏™‡πà‡∏ß‡∏ô‡∏Ç‡∏≠‡∏á‡∏£‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏¢\r\n   */\n  calculateBodyPartScores(angleComparisons) {\n    const bodyParts = {\n      '‡πÅ‡∏Ç‡∏ô‡∏ã‡πâ‡∏≤‡∏¢': ['LEFT_ARM_ANGLE'],\n      '‡πÅ‡∏Ç‡∏ô‡∏Ç‡∏ß‡∏≤': ['RIGHT_ARM_ANGLE'],\n      '‡∏Ç‡∏≤‡∏ã‡πâ‡∏≤‡∏¢': ['LEFT_LEG_ANGLE'],\n      '‡∏Ç‡∏≤‡∏Ç‡∏ß‡∏≤': ['RIGHT_LEG_ANGLE'],\n      '‡∏•‡∏≥‡∏ï‡∏±‡∏ß': ['LEFT_TORSO_ANGLE', 'RIGHT_TORSO_ANGLE'],\n      '‡∏ó‡πà‡∏≤‡∏ó‡∏≤‡∏á': ['SHOULDER_ANGLE', 'HIP_ANGLE']\n    };\n    const scores = {};\n    Object.entries(bodyParts).forEach(([bodyPart, joints]) => {\n      let totalScore = 0;\n      let count = 0;\n      joints.forEach(joint => {\n        if (angleComparisons[joint] && angleComparisons[joint].accuracy > 0) {\n          totalScore += angleComparisons[joint].accuracy;\n          count++;\n        }\n      });\n      scores[bodyPart] = count > 0 ? totalScore / count : 0;\n    });\n    return scores;\n  }\n\n  /**\r\n   * üí° ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÄ‡∏â‡∏û‡∏≤‡∏∞\r\n   */\n  generateRecommendations(angleComparisons) {\n    const recommendations = [];\n    Object.entries(angleComparisons).forEach(([jointName, comparison]) => {\n      if (comparison.accuracy < 70 && comparison.accuracy > 0) {\n        const suggestion = this.getJointSpecificSuggestion(jointName, comparison);\n        if (suggestion) {\n          recommendations.push({\n            bodyPart: this.getJointNameThai(jointName),\n            issue: `${this.getJointNameThai(jointName)}‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡πÇ‡∏Ñ‡πâ‡∏ä`,\n            suggestion: suggestion,\n            accuracy: comparison.accuracy\n          });\n        }\n      }\n    });\n\n    // Sort by accuracy (lowest first)\n    return recommendations.sort((a, b) => a.accuracy - b.accuracy).slice(0, 3);\n  }\n\n  /**\r\n   * üéØ ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏Ç‡πâ‡∏≠‡∏ï‡πà‡∏≠\r\n   */\n  getJointSpecificSuggestion(jointName, comparison) {\n    const suggestions = {\n      'LEFT_ARM_ANGLE': '‡∏õ‡∏£‡∏±‡∏ö‡∏°‡∏∏‡∏°‡πÅ‡∏Ç‡∏ô‡∏ã‡πâ‡∏≤‡∏¢‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡πÇ‡∏Ñ‡πâ‡∏ä',\n      'RIGHT_ARM_ANGLE': '‡∏õ‡∏£‡∏±‡∏ö‡∏°‡∏∏‡∏°‡πÅ‡∏Ç‡∏ô‡∏Ç‡∏ß‡∏≤‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡πÇ‡∏Ñ‡πâ‡∏ä',\n      'LEFT_LEG_ANGLE': '‡∏õ‡∏£‡∏±‡∏ö‡∏°‡∏∏‡∏°‡∏Ç‡∏≤‡∏ã‡πâ‡∏≤‡∏¢‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡πÇ‡∏Ñ‡πâ‡∏ä',\n      'RIGHT_LEG_ANGLE': '‡∏õ‡∏£‡∏±‡∏ö‡∏°‡∏∏‡∏°‡∏Ç‡∏≤‡∏Ç‡∏ß‡∏≤‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡πÇ‡∏Ñ‡πâ‡∏ä',\n      'LEFT_TORSO_ANGLE': '‡∏õ‡∏£‡∏±‡∏ö‡∏ó‡πà‡∏≤‡∏•‡∏≥‡∏ï‡∏±‡∏ß‡∏ã‡πâ‡∏≤‡∏¢‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡πÇ‡∏Ñ‡πâ‡∏ä',\n      'RIGHT_TORSO_ANGLE': '‡∏õ‡∏£‡∏±‡∏ö‡∏ó‡πà‡∏≤‡∏•‡∏≥‡∏ï‡∏±‡∏ß‡∏Ç‡∏ß‡∏≤‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡πÇ‡∏Ñ‡πâ‡∏ä',\n      'SHOULDER_ANGLE': '‡∏õ‡∏£‡∏±‡∏ö‡∏£‡∏∞‡∏î‡∏±‡∏ö‡πÑ‡∏´‡∏•‡πà‡πÉ‡∏´‡πâ‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ô',\n      'HIP_ANGLE': '‡∏õ‡∏£‡∏±‡∏ö‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏™‡∏∞‡πÇ‡∏û‡∏Å‡πÉ‡∏´‡πâ‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ô'\n    };\n    return suggestions[jointName] || '‡∏õ‡∏£‡∏±‡∏ö‡∏ó‡πà‡∏≤‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡πÇ‡∏Ñ‡πâ‡∏ä';\n  }\n\n  /**\r\n   * üáπüá≠ ‡πÅ‡∏õ‡∏•‡∏ä‡∏∑‡πà‡∏≠‡∏Ç‡πâ‡∏≠‡∏ï‡πà‡∏≠‡πÄ‡∏õ‡πá‡∏ô‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢\r\n   */\n  getJointNameThai(jointName) {\n    const names = {\n      'LEFT_ARM_ANGLE': '‡πÅ‡∏Ç‡∏ô‡∏ã‡πâ‡∏≤‡∏¢',\n      'RIGHT_ARM_ANGLE': '‡πÅ‡∏Ç‡∏ô‡∏Ç‡∏ß‡∏≤',\n      'LEFT_LEG_ANGLE': '‡∏Ç‡∏≤‡∏ã‡πâ‡∏≤‡∏¢',\n      'RIGHT_LEG_ANGLE': '‡∏Ç‡∏≤‡∏Ç‡∏ß‡∏≤',\n      'LEFT_TORSO_ANGLE': '‡∏•‡∏≥‡∏ï‡∏±‡∏ß‡∏ã‡πâ‡∏≤‡∏¢',\n      'RIGHT_TORSO_ANGLE': '‡∏•‡∏≥‡∏ï‡∏±‡∏ß‡∏Ç‡∏ß‡∏≤',\n      'SHOULDER_ANGLE': '‡πÑ‡∏´‡∏•‡πà',\n      'HIP_ANGLE': '‡∏™‡∏∞‡πÇ‡∏û‡∏Å'\n    };\n    return names[jointName] || '‡∏ó‡πà‡∏≤‡∏ó‡∏≤‡∏á';\n  }\n\n  /**\r\n   * üß≠ ‡πÅ‡∏õ‡∏•‡∏ó‡∏¥‡∏®‡∏ó‡∏≤‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢\r\n   */\n  getDirectionThai(direction) {\n    const directions = {\n      'FRONT': '‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡∏£‡∏á',\n      'FRONT_RIGHT': '‡πÄ‡∏â‡∏µ‡∏¢‡∏á‡∏Ç‡∏ß‡∏≤‡∏´‡∏ô‡πâ‡∏≤',\n      'RIGHT': '‡∏Ç‡πâ‡∏≤‡∏á‡∏Ç‡∏ß‡∏≤',\n      'BACK_RIGHT': '‡πÄ‡∏â‡∏µ‡∏¢‡∏á‡∏Ç‡∏ß‡∏≤‡∏´‡∏•‡∏±‡∏á',\n      'BACK': '‡∏´‡∏•‡∏±‡∏á',\n      'BACK_LEFT': '‡πÄ‡∏â‡∏µ‡∏¢‡∏á‡∏ã‡πâ‡∏≤‡∏¢‡∏´‡∏•‡∏±‡∏á',\n      'LEFT': '‡∏Ç‡πâ‡∏≤‡∏á‡∏ã‡πâ‡∏≤‡∏¢',\n      'FRONT_LEFT': '‡πÄ‡∏â‡∏µ‡∏¢‡∏á‡∏ã‡πâ‡∏≤‡∏¢‡∏´‡∏ô‡πâ‡∏≤'\n    };\n    return directions[direction] || '‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡∏£‡∏á';\n  }\n\n  /**\r\n   * üìè ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì confidence level\r\n   */\n  calculateConfidence(trainerAngles, traineeAngles) {\n    let validAngles = 0;\n    let totalAngles = 0;\n    Object.keys(this.JOINT_ANGLES).forEach(jointName => {\n      totalAngles++;\n      if (trainerAngles[jointName] !== null && traineeAngles[jointName] !== null) {\n        validAngles++;\n      }\n    });\n    return Math.round(validAngles / totalAngles * 100);\n  }\n\n  /**\r\n   * ‚úÖ ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏Ç‡∏≠‡∏á pose data\r\n   */\n  isValidPose(pose) {\n    if (!pose || !Array.isArray(pose) || pose.length < 33) {\n      return false;\n    }\n\n    // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏à‡∏∏‡∏î‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏≠‡∏á‡πÄ‡∏´‡πá‡∏ô‡πÑ‡∏î‡πâ (‡πÑ‡∏´‡∏•‡πà, ‡∏™‡∏∞‡πÇ‡∏û‡∏Å, ‡∏´‡∏±‡∏ß‡πÄ‡∏Ç‡πà‡∏≤)\n    const criticalPoints = [this.LANDMARKS.LEFT_SHOULDER, this.LANDMARKS.RIGHT_SHOULDER, this.LANDMARKS.LEFT_HIP, this.LANDMARKS.RIGHT_HIP, this.LANDMARKS.LEFT_KNEE, this.LANDMARKS.RIGHT_KNEE];\n    const visibleCriticalPoints = criticalPoints.filter(index => pose[index] && pose[index].visibility > this.MIN_VISIBILITY).length;\n\n    // ‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ‡∏à‡∏∏‡∏î‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏°‡∏≠‡∏á‡πÄ‡∏´‡πá‡∏ô‡πÑ‡∏î‡πâ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 4 ‡∏à‡∏∏‡∏î‡∏à‡∏≤‡∏Å 6 ‡∏à‡∏∏‡∏î\n    return visibleCriticalPoints >= 4;\n  }\n\n  /**\r\n   * üëÅÔ∏è ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏à‡∏∏‡∏î‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏°‡∏≠‡∏á‡πÄ‡∏´‡πá‡∏ô‡πÑ‡∏î‡πâ\r\n   */\n  arePointsVisible(points) {\n    return points.every(point => point && typeof point.visibility === 'number' && point.visibility > this.MIN_VISIBILITY);\n  }\n\n  /**\r\n   * ‚ùå ‡∏™‡∏£‡πâ‡∏≤‡∏á error result\r\n   */\n  getErrorResult(message) {\n    return {\n      accuracy: 0,\n      confidence: 0,\n      feedback: message,\n      jointComparisons: {},\n      trainerDirection: 'UNKNOWN',\n      traineeDirection: 'UNKNOWN',\n      bodyPartScores: {},\n      recommendations: []\n    };\n  }\n\n  /**\r\n   * üé® ‡∏™‡∏µ accuracy ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö UI\r\n   */\n  getAccuracyColor(accuracy) {\n    if (accuracy >= 85) return '#22c55e'; // Green\n    if (accuracy >= 70) return '#eab308'; // Yellow\n    if (accuracy >= 50) return '#f97316'; // Orange\n    return '#ef4444'; // Red\n  }\n}\n\n// Export singleton instance\nexport const multiDirectionalPoseComparator = new MultiDirectionalPoseComparator();\nexport default MultiDirectionalPoseComparator;","map":{"version":3,"names":["MultiDirectionalPoseComparator","constructor","LANDMARKS","LEFT_SHOULDER","RIGHT_SHOULDER","LEFT_ELBOW","RIGHT_ELBOW","LEFT_WRIST","RIGHT_WRIST","LEFT_HIP","RIGHT_HIP","LEFT_KNEE","RIGHT_KNEE","LEFT_ANKLE","RIGHT_ANKLE","NOSE","LEFT_EAR","RIGHT_EAR","JOINT_ANGLES","LEFT_ARM_ANGLE","RIGHT_ARM_ANGLE","LEFT_LEG_ANGLE","RIGHT_LEG_ANGLE","LEFT_TORSO_ANGLE","RIGHT_TORSO_ANGLE","SHOULDER_ANGLE","HIP_ANGLE","DIRECTIONS","FRONT","FRONT_RIGHT","RIGHT","BACK_RIGHT","BACK","BACK_LEFT","LEFT","FRONT_LEFT","JOINT_WEIGHTS","MIN_VISIBILITY","compareMultiDirectional","trainerPose","traineePose","isValidPose","getErrorResult","isActiveExercisePose","accuracy","confidence","feedback","jointComparisons","trainerDirection","traineeDirection","bodyPartScores","recommendations","trainerAngles","calculateAllJointAngles","traineeAngles","detectBodyDirection","angleComparisons","compareJointAngles","calculateWeightedAccuracy","generateDirectionalFeedback","Math","round","calculateConfidence","calculateBodyPartScores","generateRecommendations","calculateAngle","p1","p2","p3","v1","x","y","v2","dot","cross","angle","atan2","PI","pose","angles","Object","entries","forEach","jointName","p1Idx","p2Idx","p3Idx","arePointsVisible","leftShoulder","rightShoulder","nose","shoulderAngle","normalizedAngle","closestDirection","minDifference","Infinity","direction","difference","min","abs","comparisons","keys","trainerAngle","traineeAngle","angleDiff","max","angleDifference","weight","error","totalWeightedScore","totalWeight","majorDifferences","values","comparison","baseAccuracy","penaltyFactor","worstJoint","findWorstJoint","getJointNameThai","getDirectionThai","lowestAccuracy","bodyParts","scores","bodyPart","joints","totalScore","count","joint","suggestion","getJointSpecificSuggestion","push","issue","sort","a","b","slice","suggestions","names","directions","validAngles","totalAngles","Array","isArray","length","criticalPoints","visibleCriticalPoints","filter","index","visibility","points","every","point","message","getAccuracyColor","multiDirectionalPoseComparator"],"sources":["E:/BackupFit/frontend/src/utils/MultiDirectionalPoseComparator.js"],"sourcesContent":["/**\r\n * üéØ Advanced Multi-Directional Pose Comparator\r\n * ‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏ó‡πà‡∏≤‡∏ó‡∏≤‡∏á‡πÅ‡∏ö‡∏ö 8 ‡∏ó‡∏¥‡∏®‡∏ó‡∏≤‡∏á ‡πÇ‡∏î‡∏¢‡πÉ‡∏ä‡πâ‡∏°‡∏∏‡∏°‡∏Ç‡πâ‡∏≠‡∏ï‡πà‡∏≠‡πÅ‡∏ó‡∏ô‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏à‡∏∏‡∏î\r\n * \r\n * Concept: \r\n * - ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏°‡∏∏‡∏°‡∏Ç‡πâ‡∏≠‡∏ï‡πà‡∏≠‡∏´‡∏•‡∏±‡∏Å‡∏à‡∏≤‡∏Å keypoints (Joint Angles)\r\n * - ‡πÅ‡∏õ‡∏•‡∏á‡πÄ‡∏õ‡πá‡∏ô 8 ‡∏ó‡∏¥‡∏®‡∏ó‡∏≤‡∏á (Front, Back, Left, Right, ‡πÅ‡∏•‡∏∞ 4 ‡πÄ‡∏â‡∏µ‡∏¢‡∏á)\r\n * - ‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö trainee ‡∏Å‡∏±‡∏ö trainer ‡πÅ‡∏ö‡∏ö real-time\r\n */\r\n\r\nexport class MultiDirectionalPoseComparator {\r\n  constructor() {\r\n    // MediaPipe Pose landmark indices\r\n    this.LANDMARKS = {\r\n      // Upper body key points\r\n      LEFT_SHOULDER: 11, RIGHT_SHOULDER: 12,\r\n      LEFT_ELBOW: 13, RIGHT_ELBOW: 14,\r\n      LEFT_WRIST: 15, RIGHT_WRIST: 16,\r\n      LEFT_HIP: 23, RIGHT_HIP: 24,\r\n      LEFT_KNEE: 25, RIGHT_KNEE: 26,\r\n      LEFT_ANKLE: 27, RIGHT_ANKLE: 28,\r\n      NOSE: 0,\r\n      LEFT_EAR: 7, RIGHT_EAR: 8\r\n    };\r\n\r\n    // Joint angle definitions - ‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏°‡∏∏‡∏°‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏î‡πâ‡∏ß‡∏¢ 3 ‡∏à‡∏∏‡∏î [‡∏à‡∏∏‡∏î‡πÅ‡∏£‡∏Å, ‡∏à‡∏∏‡∏î‡∏Å‡∏∂‡πà‡∏á‡∏Å‡∏•‡∏≤‡∏á, ‡∏à‡∏∏‡∏î‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢]\r\n    this.JOINT_ANGLES = {\r\n      // ‡πÅ‡∏Ç‡∏ô‡∏ã‡πâ‡∏≤‡∏¢\r\n      LEFT_ARM_ANGLE: [this.LANDMARKS.LEFT_SHOULDER, this.LANDMARKS.LEFT_ELBOW, this.LANDMARKS.LEFT_WRIST],\r\n      // ‡πÅ‡∏Ç‡∏ô‡∏Ç‡∏ß‡∏≤  \r\n      RIGHT_ARM_ANGLE: [this.LANDMARKS.RIGHT_SHOULDER, this.LANDMARKS.RIGHT_ELBOW, this.LANDMARKS.RIGHT_WRIST],\r\n      // ‡∏Ç‡∏≤‡∏ã‡πâ‡∏≤‡∏¢\r\n      LEFT_LEG_ANGLE: [this.LANDMARKS.LEFT_HIP, this.LANDMARKS.LEFT_KNEE, this.LANDMARKS.LEFT_ANKLE],\r\n      // ‡∏Ç‡∏≤‡∏Ç‡∏ß‡∏≤\r\n      RIGHT_LEG_ANGLE: [this.LANDMARKS.RIGHT_HIP, this.LANDMARKS.RIGHT_KNEE, this.LANDMARKS.RIGHT_ANKLE],\r\n      // ‡∏•‡∏≥‡∏ï‡∏±‡∏ß‡∏ã‡πâ‡∏≤‡∏¢\r\n      LEFT_TORSO_ANGLE: [this.LANDMARKS.LEFT_SHOULDER, this.LANDMARKS.LEFT_HIP, this.LANDMARKS.LEFT_KNEE],\r\n      // ‡∏•‡∏≥‡∏ï‡∏±‡∏ß‡∏Ç‡∏ß‡∏≤\r\n      RIGHT_TORSO_ANGLE: [this.LANDMARKS.RIGHT_SHOULDER, this.LANDMARKS.RIGHT_HIP, this.LANDMARKS.RIGHT_KNEE],\r\n      // ‡πÑ‡∏´‡∏•‡πà (shoulder alignment)\r\n      SHOULDER_ANGLE: [this.LANDMARKS.LEFT_SHOULDER, this.LANDMARKS.NOSE, this.LANDMARKS.RIGHT_SHOULDER],\r\n      // ‡∏™‡∏∞‡πÇ‡∏û‡∏Å (hip alignment)  \r\n      HIP_ANGLE: [this.LANDMARKS.LEFT_HIP, this.LANDMARKS.NOSE, this.LANDMARKS.RIGHT_HIP]\r\n    };\r\n\r\n    // 8 ‡∏ó‡∏¥‡∏®‡∏ó‡∏≤‡∏á‡∏´‡∏•‡∏±‡∏Å (degrees)\r\n    this.DIRECTIONS = {\r\n      FRONT: 0,           // ‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡∏£‡∏á\r\n      FRONT_RIGHT: 45,    // ‡πÄ‡∏â‡∏µ‡∏¢‡∏á‡∏Ç‡∏ß‡∏≤‡∏´‡∏ô‡πâ‡∏≤\r\n      RIGHT: 90,          // ‡∏Ç‡πâ‡∏≤‡∏á‡∏Ç‡∏ß‡∏≤\r\n      BACK_RIGHT: 135,    // ‡πÄ‡∏â‡∏µ‡∏¢‡∏á‡∏Ç‡∏ß‡∏≤‡∏´‡∏•‡∏±‡∏á\r\n      BACK: 180,          // ‡∏´‡∏•‡∏±‡∏á\r\n      BACK_LEFT: 225,     // ‡πÄ‡∏â‡∏µ‡∏¢‡∏á‡∏ã‡πâ‡∏≤‡∏¢‡∏´‡∏•‡∏±‡∏á\r\n      LEFT: 270,          // ‡∏Ç‡πâ‡∏≤‡∏á‡∏ã‡πâ‡∏≤‡∏¢\r\n      FRONT_LEFT: 315     // ‡πÄ‡∏â‡∏µ‡∏¢‡∏á‡∏ã‡πâ‡∏≤‡∏¢‡∏´‡∏ô‡πâ‡∏≤\r\n    };\r\n\r\n    // ‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏Ç‡∏≠‡∏á‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏Ç‡πâ‡∏≠‡∏ï‡πà‡∏≠\r\n    this.JOINT_WEIGHTS = {\r\n      LEFT_ARM_ANGLE: 1.5,\r\n      RIGHT_ARM_ANGLE: 1.5,\r\n      LEFT_LEG_ANGLE: 2.0,\r\n      RIGHT_LEG_ANGLE: 2.0,\r\n      LEFT_TORSO_ANGLE: 2.5,\r\n      RIGHT_TORSO_ANGLE: 2.5,\r\n      SHOULDER_ANGLE: 1.8,\r\n      HIP_ANGLE: 1.8\r\n    };\r\n\r\n    // Minimum visibility threshold\r\n    this.MIN_VISIBILITY = 0.6;\r\n  }\r\n\r\n  /**\r\n   * üéØ Main comparison function - Multi-directional pose matching\r\n   * @param {Array} trainerPose - Trainer's keypoints\r\n   * @param {Array} traineePose - Trainee's keypoints (real-time)\r\n   * @returns {Object} - Comparison result with accuracy and detailed analysis\r\n   */\r\n  compareMultiDirectional(trainerPose, traineePose) {\r\n    if (!this.isValidPose(trainerPose) || !this.isValidPose(traineePose)) {\r\n      return this.getErrorResult(\"Invalid pose data\");\r\n    }\r\n\r\n    // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ trainee ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏ó‡πà‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà\r\n    if (!this.isActiveExercisePose(traineePose)) {\r\n      return {\r\n        accuracy: 0,\r\n        confidence: 0,\r\n        feedback: \"üö∂‚Äç‚ôÇÔ∏è ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏≥‡∏ó‡πà‡∏≤‡∏ï‡∏≤‡∏°‡∏Ñ‡∏•‡∏¥‡∏õ\",\r\n        jointComparisons: {},\r\n        trainerDirection: \"unknown\",\r\n        traineeDirection: \"unknown\",\r\n        bodyPartScores: {},\r\n        recommendations: [\"‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏≥‡∏ó‡πà‡∏≤‡∏≠‡∏≠‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏¢‡∏ï‡∏≤‡∏°‡∏ó‡∏µ‡πà‡πÄ‡∏´‡πá‡∏ô‡πÉ‡∏ô‡∏Ñ‡∏•‡∏¥‡∏õ\"]\r\n      };\r\n    }\r\n\r\n    // 1. ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏°‡∏∏‡∏°‡∏Ç‡πâ‡∏≠‡∏ï‡πà‡∏≠‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏Ç‡∏≠‡∏á trainer ‡πÅ‡∏•‡∏∞ trainee\r\n    const trainerAngles = this.calculateAllJointAngles(trainerPose);\r\n    const traineeAngles = this.calculateAllJointAngles(traineePose);\r\n\r\n    // 2. ‡∏£‡∏∞‡∏ö‡∏∏‡∏ó‡∏¥‡∏®‡∏ó‡∏≤‡∏á‡∏´‡∏•‡∏±‡∏Å‡∏Ç‡∏≠‡∏á‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏Ñ‡∏ô (‡πÉ‡∏ä‡πâ shoulder orientation)\r\n    const trainerDirection = this.detectBodyDirection(trainerPose);\r\n    const traineeDirection = this.detectBodyDirection(traineePose);\r\n\r\n    // 3. ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡πà‡∏≤‡∏á‡∏°‡∏∏‡∏°‡∏Ç‡πâ‡∏≠‡∏ï‡πà‡∏≠‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏ï‡∏±‡∏ß\r\n    const angleComparisons = this.compareJointAngles(trainerAngles, traineeAngles);\r\n\r\n    // 4. ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì accuracy ‡πÇ‡∏î‡∏¢‡∏£‡∏ß‡∏°\r\n    const accuracy = this.calculateWeightedAccuracy(angleComparisons);\r\n\r\n    // 5. ‡∏™‡∏£‡πâ‡∏≤‡∏á feedback ‡πÅ‡∏•‡∏∞‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥\r\n    const feedback = this.generateDirectionalFeedback(accuracy, angleComparisons, trainerDirection, traineeDirection);\r\n\r\n    return {\r\n      accuracy: Math.round(accuracy),\r\n      confidence: this.calculateConfidence(trainerAngles, traineeAngles),\r\n      feedback,\r\n      jointComparisons: angleComparisons,\r\n      trainerDirection,\r\n      traineeDirection,\r\n      bodyPartScores: this.calculateBodyPartScores(angleComparisons),\r\n      recommendations: this.generateRecommendations(angleComparisons)\r\n    };\r\n  }\r\n\r\n  /**\r\n   * üìê ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏°‡∏∏‡∏°‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏™‡∏≤‡∏°‡∏à‡∏∏‡∏î (P1-P2-P3) ‡πÇ‡∏î‡∏¢ P2 ‡πÄ‡∏õ‡πá‡∏ô‡∏à‡∏∏‡∏î‡∏Å‡∏∂‡πà‡∏á‡∏Å‡∏•‡∏≤‡∏á\r\n   */\r\n  calculateAngle(p1, p2, p3) {\r\n    if (!p1 || !p2 || !p3) return null;\r\n    \r\n    // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÄ‡∏ß‡∏Å‡πÄ‡∏ï‡∏≠‡∏£‡πå\r\n    const v1 = { x: p1.x - p2.x, y: p1.y - p2.y };\r\n    const v2 = { x: p3.x - p2.x, y: p3.y - p2.y };\r\n    \r\n    // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏°‡∏∏‡∏°‡πÇ‡∏î‡∏¢‡πÉ‡∏ä‡πâ dot product ‡πÅ‡∏•‡∏∞ cross product\r\n    const dot = v1.x * v2.x + v1.y * v2.y;\r\n    const cross = v1.x * v2.y - v1.y * v2.x;\r\n    \r\n    let angle = Math.atan2(cross, dot) * (180 / Math.PI);\r\n    \r\n    // ‡πÅ‡∏õ‡∏•‡∏á‡πÄ‡∏õ‡πá‡∏ô positive angle (0-360)\r\n    if (angle < 0) angle += 360;\r\n    \r\n    return angle;\r\n  }\r\n\r\n  /**\r\n   * üîç ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏°‡∏∏‡∏°‡∏Ç‡πâ‡∏≠‡∏ï‡πà‡∏≠‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î\r\n   */\r\n  calculateAllJointAngles(pose) {\r\n    const angles = {};\r\n    \r\n    Object.entries(this.JOINT_ANGLES).forEach(([jointName, [p1Idx, p2Idx, p3Idx]]) => {\r\n      const p1 = pose[p1Idx];\r\n      const p2 = pose[p2Idx];\r\n      const p3 = pose[p3Idx];\r\n      \r\n      // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏à‡∏∏‡∏î‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏≤‡∏°‡∏°‡∏≠‡∏á‡πÄ‡∏´‡πá‡∏ô‡πÑ‡∏î‡πâ‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô\r\n      if (this.arePointsVisible([p1, p2, p3])) {\r\n        angles[jointName] = this.calculateAngle(p1, p2, p3);\r\n      } else {\r\n        angles[jointName] = null; // ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÑ‡∏î‡πâ\r\n      }\r\n    });\r\n    \r\n    return angles;\r\n  }\r\n\r\n  /**\r\n   * üß≠ ‡∏ï‡∏£‡∏ß‡∏à‡∏à‡∏±‡∏ö‡∏ó‡∏¥‡∏®‡∏ó‡∏≤‡∏á‡∏£‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏¢‡∏´‡∏•‡∏±‡∏Å (‡πÉ‡∏ä‡πâ‡πÑ‡∏´‡∏•‡πà‡πÄ‡∏õ‡πá‡∏ô‡∏´‡∏•‡∏±‡∏Å)\r\n   */\r\n  detectBodyDirection(pose) {\r\n    const leftShoulder = pose[this.LANDMARKS.LEFT_SHOULDER];\r\n    const rightShoulder = pose[this.LANDMARKS.RIGHT_SHOULDER];\r\n    const nose = pose[this.LANDMARKS.NOSE];\r\n    \r\n    if (!this.arePointsVisible([leftShoulder, rightShoulder, nose])) {\r\n      return 'UNKNOWN';\r\n    }\r\n    \r\n    // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏°‡∏∏‡∏°‡πÑ‡∏´‡∏•‡πà‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏Å‡∏±‡∏ö‡πÅ‡∏ô‡∏ß‡∏ô‡∏≠‡∏ô\r\n    const shoulderAngle = Math.atan2(\r\n      rightShoulder.y - leftShoulder.y,\r\n      rightShoulder.x - leftShoulder.x\r\n    ) * (180 / Math.PI);\r\n    \r\n    // ‡πÅ‡∏õ‡∏•‡∏á‡πÄ‡∏õ‡πá‡∏ô positive angle\r\n    let normalizedAngle = shoulderAngle < 0 ? shoulderAngle + 360 : shoulderAngle;\r\n    \r\n    // ‡∏à‡∏±‡∏ö‡∏Ñ‡∏π‡πà‡∏Å‡∏±‡∏ö‡∏ó‡∏¥‡∏®‡∏ó‡∏≤‡∏á‡∏ó‡∏µ‡πà‡πÉ‡∏Å‡∏•‡πâ‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î\r\n    let closestDirection = 'FRONT';\r\n    let minDifference = Infinity;\r\n    \r\n    Object.entries(this.DIRECTIONS).forEach(([direction, angle]) => {\r\n      const difference = Math.min(\r\n        Math.abs(normalizedAngle - angle),\r\n        Math.abs(normalizedAngle - angle + 360),\r\n        Math.abs(normalizedAngle - angle - 360)\r\n      );\r\n      \r\n      if (difference < minDifference) {\r\n        minDifference = difference;\r\n        closestDirection = direction;\r\n      }\r\n    });\r\n    \r\n    return closestDirection;\r\n  }\r\n\r\n  /**\r\n   * ‚öñÔ∏è ‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏°‡∏∏‡∏°‡∏Ç‡πâ‡∏≠‡∏ï‡πà‡∏≠‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á trainer ‡πÅ‡∏•‡∏∞ trainee\r\n   */\r\n  compareJointAngles(trainerAngles, traineeAngles) {\r\n    const comparisons = {};\r\n    \r\n    Object.keys(this.JOINT_ANGLES).forEach(jointName => {\r\n      const trainerAngle = trainerAngles[jointName];\r\n      const traineeAngle = traineeAngles[jointName];\r\n      \r\n      if (trainerAngle !== null && traineeAngle !== null) {\r\n        // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡πà‡∏≤‡∏á‡∏°‡∏∏‡∏° (‡∏´‡∏≤‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏ô‡πâ‡∏≠‡∏¢‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡πÉ‡∏ô 360 ‡∏≠‡∏á‡∏®‡∏≤)\r\n        let angleDiff = Math.abs(trainerAngle - traineeAngle);\r\n        angleDiff = Math.min(angleDiff, 360 - angleDiff);\r\n        \r\n        // ‡πÅ‡∏õ‡∏•‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥ (‡∏¢‡∏¥‡πà‡∏á‡∏ï‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ = ‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥‡∏°‡∏≤‡∏Å) - ‡πÄ‡∏Ç‡πâ‡∏°‡∏á‡∏ß‡∏î‡∏°‡∏≤‡∏Å‡∏Ç‡∏∂‡πâ‡∏ô\r\n        const accuracy = Math.max(0, 100 - (angleDiff * 3.0)); // ‡πÄ‡∏û‡∏¥‡πà‡∏° sensitivity factor ‡∏à‡∏≤‡∏Å 1.2 ‡πÄ‡∏õ‡πá‡∏ô 3.0\r\n        \r\n        comparisons[jointName] = {\r\n          trainerAngle: Math.round(trainerAngle),\r\n          traineeAngle: Math.round(traineeAngle),\r\n          angleDifference: Math.round(angleDiff),\r\n          accuracy: Math.round(accuracy),\r\n          weight: this.JOINT_WEIGHTS[jointName] || 1.0\r\n        };\r\n      } else {\r\n        comparisons[jointName] = {\r\n          trainerAngle: trainerAngle,\r\n          traineeAngle: traineeAngle,\r\n          angleDifference: null,\r\n          accuracy: 0,\r\n          weight: this.JOINT_WEIGHTS[jointName] || 1.0,\r\n          error: 'Points not visible'\r\n        };\r\n      }\r\n    });\r\n    \r\n    return comparisons;\r\n  }\r\n\r\n  /**\r\n   * üìä ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì accuracy ‡πÇ‡∏î‡∏¢‡∏£‡∏ß‡∏°‡πÅ‡∏ö‡∏ö‡∏°‡∏µ‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å\r\n   */\r\n  calculateWeightedAccuracy(angleComparisons) {\r\n    let totalWeightedScore = 0;\r\n    let totalWeight = 0;\r\n    let majorDifferences = 0; // ‡∏ô‡∏±‡∏ö‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ç‡πâ‡∏≠‡∏ï‡πà‡∏≠‡∏ó‡∏µ‡πà‡∏ï‡πà‡∏≤‡∏á‡∏Å‡∏±‡∏ô‡∏°‡∏≤‡∏Å\r\n    \r\n    Object.values(angleComparisons).forEach(comparison => {\r\n      if (comparison.accuracy >= 0) {\r\n        totalWeightedScore += comparison.accuracy * comparison.weight;\r\n        totalWeight += comparison.weight;\r\n        \r\n        // ‡∏ñ‡πâ‡∏≤‡∏°‡∏∏‡∏°‡∏ï‡πà‡∏≤‡∏á‡∏Å‡∏±‡∏ô‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤ 30 ‡∏≠‡∏á‡∏®‡∏≤ ‡∏ñ‡∏∑‡∏≠‡∏ß‡πà‡∏≤‡∏ó‡πà‡∏≤‡∏ú‡∏¥‡∏î‡∏°‡∏≤‡∏Å\r\n        if (comparison.angleDifference > 30) {\r\n          majorDifferences++;\r\n        }\r\n      }\r\n    });\r\n    \r\n    const baseAccuracy = totalWeight > 0 ? totalWeightedScore / totalWeight : 0;\r\n    \r\n    // ‡∏•‡∏á‡πÇ‡∏ó‡∏©‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡∏ó‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏ú‡∏¥‡∏î‡∏°‡∏≤‡∏Å (‡∏ï‡πà‡∏≤‡∏á‡∏Å‡∏±‡∏ô‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤ 30 ‡∏≠‡∏á‡∏®‡∏≤)\r\n    const penaltyFactor = Math.max(0.1, 1 - (majorDifferences * 0.15)); // ‡∏•‡∏î‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô 15% ‡∏ï‡πà‡∏≠‡∏ó‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏ú‡∏¥‡∏î‡∏°‡∏≤‡∏Å\r\n    \r\n    return Math.max(0, baseAccuracy * penaltyFactor);\r\n  }\r\n\r\n  /**\r\n   * üí¨ ‡∏™‡∏£‡πâ‡∏≤‡∏á feedback ‡∏ï‡∏≤‡∏°‡∏ó‡∏¥‡∏®‡∏ó‡∏≤‡∏á\r\n   */\r\n  generateDirectionalFeedback(accuracy, angleComparisons, trainerDirection, traineeDirection) {\r\n    if (accuracy >= 90) {\r\n      return \"üéâ ‡∏¢‡∏≠‡∏î‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°! ‡∏ó‡πà‡∏≤‡∏≠‡∏≠‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏¢‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥‡∏°‡∏≤‡∏Å\";\r\n    } else if (accuracy >= 80) {\r\n      return \"üëç ‡∏î‡∏µ‡∏°‡∏≤‡∏Å! ‡πÄ‡∏Å‡∏∑‡∏≠‡∏ö‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå‡πÅ‡∏•‡πâ‡∏ß\";\r\n    } else if (accuracy >= 70) {\r\n      return \"‚ö° ‡πÉ‡∏Å‡∏•‡πâ‡πÄ‡∏Ñ‡∏µ‡∏¢‡∏á‡πÅ‡∏•‡πâ‡∏ß ‡∏õ‡∏£‡∏±‡∏ö‡∏ó‡πà‡∏≤‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢\";\r\n    } else if (accuracy >= 60) {\r\n      // ‡∏´‡∏≤‡∏Ç‡πâ‡∏≠‡∏ï‡πà‡∏≠‡∏ó‡∏µ‡πà‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥‡∏ô‡πâ‡∏≠‡∏¢‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î\r\n      const worstJoint = this.findWorstJoint(angleComparisons);\r\n      return `‚ö†Ô∏è ‡∏õ‡∏£‡∏±‡∏ö${this.getJointNameThai(worstJoint)}‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏á‡∏°‡∏≤‡∏Å‡∏Ç‡∏∂‡πâ‡∏ô`;\r\n    } else if (accuracy >= 40) {\r\n      return `üîÑ ‡∏•‡∏≠‡∏á‡∏´‡∏±‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡πÑ‡∏õ‡∏ó‡∏≤‡∏á${this.getDirectionThai(trainerDirection)}‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÇ‡∏Ñ‡πâ‡∏ä`;\r\n    } else {\r\n      return \"üéØ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÉ‡∏´‡∏°‡πà - ‡∏î‡∏π‡∏ó‡πà‡∏≤‡∏Ç‡∏≠‡∏á‡πÇ‡∏Ñ‡πâ‡∏ä‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î\";\r\n    }\r\n  }\r\n\r\n  /**\r\n   * üîç ‡∏´‡∏≤‡∏Ç‡πâ‡∏≠‡∏ï‡πà‡∏≠‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥‡∏ô‡πâ‡∏≠‡∏¢‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î\r\n   */\r\n  findWorstJoint(angleComparisons) {\r\n    let worstJoint = null;\r\n    let lowestAccuracy = 100;\r\n    \r\n    Object.entries(angleComparisons).forEach(([jointName, comparison]) => {\r\n      if (comparison.accuracy < lowestAccuracy) {\r\n        lowestAccuracy = comparison.accuracy;\r\n        worstJoint = jointName;\r\n      }\r\n    });\r\n    \r\n    return worstJoint;\r\n  }\r\n\r\n  /**\r\n   * üèãÔ∏è ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÅ‡∏¢‡∏Å‡∏ï‡∏≤‡∏°‡∏™‡πà‡∏ß‡∏ô‡∏Ç‡∏≠‡∏á‡∏£‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏¢\r\n   */\r\n  calculateBodyPartScores(angleComparisons) {\r\n    const bodyParts = {\r\n      '‡πÅ‡∏Ç‡∏ô‡∏ã‡πâ‡∏≤‡∏¢': ['LEFT_ARM_ANGLE'],\r\n      '‡πÅ‡∏Ç‡∏ô‡∏Ç‡∏ß‡∏≤': ['RIGHT_ARM_ANGLE'],\r\n      '‡∏Ç‡∏≤‡∏ã‡πâ‡∏≤‡∏¢': ['LEFT_LEG_ANGLE'],\r\n      '‡∏Ç‡∏≤‡∏Ç‡∏ß‡∏≤': ['RIGHT_LEG_ANGLE'],\r\n      '‡∏•‡∏≥‡∏ï‡∏±‡∏ß': ['LEFT_TORSO_ANGLE', 'RIGHT_TORSO_ANGLE'],\r\n      '‡∏ó‡πà‡∏≤‡∏ó‡∏≤‡∏á': ['SHOULDER_ANGLE', 'HIP_ANGLE']\r\n    };\r\n    \r\n    const scores = {};\r\n    \r\n    Object.entries(bodyParts).forEach(([bodyPart, joints]) => {\r\n      let totalScore = 0;\r\n      let count = 0;\r\n      \r\n      joints.forEach(joint => {\r\n        if (angleComparisons[joint] && angleComparisons[joint].accuracy > 0) {\r\n          totalScore += angleComparisons[joint].accuracy;\r\n          count++;\r\n        }\r\n      });\r\n      \r\n      scores[bodyPart] = count > 0 ? totalScore / count : 0;\r\n    });\r\n    \r\n    return scores;\r\n  }\r\n\r\n  /**\r\n   * üí° ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÄ‡∏â‡∏û‡∏≤‡∏∞\r\n   */\r\n  generateRecommendations(angleComparisons) {\r\n    const recommendations = [];\r\n    \r\n    Object.entries(angleComparisons).forEach(([jointName, comparison]) => {\r\n      if (comparison.accuracy < 70 && comparison.accuracy > 0) {\r\n        const suggestion = this.getJointSpecificSuggestion(jointName, comparison);\r\n        if (suggestion) {\r\n          recommendations.push({\r\n            bodyPart: this.getJointNameThai(jointName),\r\n            issue: `${this.getJointNameThai(jointName)}‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡πÇ‡∏Ñ‡πâ‡∏ä`,\r\n            suggestion: suggestion,\r\n            accuracy: comparison.accuracy\r\n          });\r\n        }\r\n      }\r\n    });\r\n    \r\n    // Sort by accuracy (lowest first)\r\n    return recommendations.sort((a, b) => a.accuracy - b.accuracy).slice(0, 3);\r\n  }\r\n\r\n  /**\r\n   * üéØ ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏Ç‡πâ‡∏≠‡∏ï‡πà‡∏≠\r\n   */\r\n  getJointSpecificSuggestion(jointName, comparison) {\r\n    const suggestions = {\r\n      'LEFT_ARM_ANGLE': '‡∏õ‡∏£‡∏±‡∏ö‡∏°‡∏∏‡∏°‡πÅ‡∏Ç‡∏ô‡∏ã‡πâ‡∏≤‡∏¢‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡πÇ‡∏Ñ‡πâ‡∏ä',\r\n      'RIGHT_ARM_ANGLE': '‡∏õ‡∏£‡∏±‡∏ö‡∏°‡∏∏‡∏°‡πÅ‡∏Ç‡∏ô‡∏Ç‡∏ß‡∏≤‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡πÇ‡∏Ñ‡πâ‡∏ä',\r\n      'LEFT_LEG_ANGLE': '‡∏õ‡∏£‡∏±‡∏ö‡∏°‡∏∏‡∏°‡∏Ç‡∏≤‡∏ã‡πâ‡∏≤‡∏¢‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡πÇ‡∏Ñ‡πâ‡∏ä',\r\n      'RIGHT_LEG_ANGLE': '‡∏õ‡∏£‡∏±‡∏ö‡∏°‡∏∏‡∏°‡∏Ç‡∏≤‡∏Ç‡∏ß‡∏≤‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡πÇ‡∏Ñ‡πâ‡∏ä',\r\n      'LEFT_TORSO_ANGLE': '‡∏õ‡∏£‡∏±‡∏ö‡∏ó‡πà‡∏≤‡∏•‡∏≥‡∏ï‡∏±‡∏ß‡∏ã‡πâ‡∏≤‡∏¢‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡πÇ‡∏Ñ‡πâ‡∏ä',\r\n      'RIGHT_TORSO_ANGLE': '‡∏õ‡∏£‡∏±‡∏ö‡∏ó‡πà‡∏≤‡∏•‡∏≥‡∏ï‡∏±‡∏ß‡∏Ç‡∏ß‡∏≤‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡πÇ‡∏Ñ‡πâ‡∏ä',\r\n      'SHOULDER_ANGLE': '‡∏õ‡∏£‡∏±‡∏ö‡∏£‡∏∞‡∏î‡∏±‡∏ö‡πÑ‡∏´‡∏•‡πà‡πÉ‡∏´‡πâ‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ô',\r\n      'HIP_ANGLE': '‡∏õ‡∏£‡∏±‡∏ö‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏™‡∏∞‡πÇ‡∏û‡∏Å‡πÉ‡∏´‡πâ‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ô'\r\n    };\r\n    \r\n    return suggestions[jointName] || '‡∏õ‡∏£‡∏±‡∏ö‡∏ó‡πà‡∏≤‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡πÇ‡∏Ñ‡πâ‡∏ä';\r\n  }\r\n\r\n  /**\r\n   * üáπüá≠ ‡πÅ‡∏õ‡∏•‡∏ä‡∏∑‡πà‡∏≠‡∏Ç‡πâ‡∏≠‡∏ï‡πà‡∏≠‡πÄ‡∏õ‡πá‡∏ô‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢\r\n   */\r\n  getJointNameThai(jointName) {\r\n    const names = {\r\n      'LEFT_ARM_ANGLE': '‡πÅ‡∏Ç‡∏ô‡∏ã‡πâ‡∏≤‡∏¢',\r\n      'RIGHT_ARM_ANGLE': '‡πÅ‡∏Ç‡∏ô‡∏Ç‡∏ß‡∏≤',\r\n      'LEFT_LEG_ANGLE': '‡∏Ç‡∏≤‡∏ã‡πâ‡∏≤‡∏¢',\r\n      'RIGHT_LEG_ANGLE': '‡∏Ç‡∏≤‡∏Ç‡∏ß‡∏≤',\r\n      'LEFT_TORSO_ANGLE': '‡∏•‡∏≥‡∏ï‡∏±‡∏ß‡∏ã‡πâ‡∏≤‡∏¢',\r\n      'RIGHT_TORSO_ANGLE': '‡∏•‡∏≥‡∏ï‡∏±‡∏ß‡∏Ç‡∏ß‡∏≤',\r\n      'SHOULDER_ANGLE': '‡πÑ‡∏´‡∏•‡πà',\r\n      'HIP_ANGLE': '‡∏™‡∏∞‡πÇ‡∏û‡∏Å'\r\n    };\r\n    \r\n    return names[jointName] || '‡∏ó‡πà‡∏≤‡∏ó‡∏≤‡∏á';\r\n  }\r\n\r\n  /**\r\n   * üß≠ ‡πÅ‡∏õ‡∏•‡∏ó‡∏¥‡∏®‡∏ó‡∏≤‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢\r\n   */\r\n  getDirectionThai(direction) {\r\n    const directions = {\r\n      'FRONT': '‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡∏£‡∏á',\r\n      'FRONT_RIGHT': '‡πÄ‡∏â‡∏µ‡∏¢‡∏á‡∏Ç‡∏ß‡∏≤‡∏´‡∏ô‡πâ‡∏≤',\r\n      'RIGHT': '‡∏Ç‡πâ‡∏≤‡∏á‡∏Ç‡∏ß‡∏≤',\r\n      'BACK_RIGHT': '‡πÄ‡∏â‡∏µ‡∏¢‡∏á‡∏Ç‡∏ß‡∏≤‡∏´‡∏•‡∏±‡∏á',\r\n      'BACK': '‡∏´‡∏•‡∏±‡∏á',\r\n      'BACK_LEFT': '‡πÄ‡∏â‡∏µ‡∏¢‡∏á‡∏ã‡πâ‡∏≤‡∏¢‡∏´‡∏•‡∏±‡∏á',\r\n      'LEFT': '‡∏Ç‡πâ‡∏≤‡∏á‡∏ã‡πâ‡∏≤‡∏¢',\r\n      'FRONT_LEFT': '‡πÄ‡∏â‡∏µ‡∏¢‡∏á‡∏ã‡πâ‡∏≤‡∏¢‡∏´‡∏ô‡πâ‡∏≤'\r\n    };\r\n    \r\n    return directions[direction] || '‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡∏£‡∏á';\r\n  }\r\n\r\n  /**\r\n   * üìè ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì confidence level\r\n   */\r\n  calculateConfidence(trainerAngles, traineeAngles) {\r\n    let validAngles = 0;\r\n    let totalAngles = 0;\r\n    \r\n    Object.keys(this.JOINT_ANGLES).forEach(jointName => {\r\n      totalAngles++;\r\n      if (trainerAngles[jointName] !== null && traineeAngles[jointName] !== null) {\r\n        validAngles++;\r\n      }\r\n    });\r\n    \r\n    return Math.round((validAngles / totalAngles) * 100);\r\n  }\r\n\r\n  /**\r\n   * ‚úÖ ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏Ç‡∏≠‡∏á pose data\r\n   */\r\n  isValidPose(pose) {\r\n    if (!pose || !Array.isArray(pose) || pose.length < 33) {\r\n      return false;\r\n    }\r\n    \r\n    // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏à‡∏∏‡∏î‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏≠‡∏á‡πÄ‡∏´‡πá‡∏ô‡πÑ‡∏î‡πâ (‡πÑ‡∏´‡∏•‡πà, ‡∏™‡∏∞‡πÇ‡∏û‡∏Å, ‡∏´‡∏±‡∏ß‡πÄ‡∏Ç‡πà‡∏≤)\r\n    const criticalPoints = [\r\n      this.LANDMARKS.LEFT_SHOULDER, this.LANDMARKS.RIGHT_SHOULDER,\r\n      this.LANDMARKS.LEFT_HIP, this.LANDMARKS.RIGHT_HIP,\r\n      this.LANDMARKS.LEFT_KNEE, this.LANDMARKS.RIGHT_KNEE\r\n    ];\r\n    \r\n    const visibleCriticalPoints = criticalPoints.filter(index => \r\n      pose[index] && pose[index].visibility > this.MIN_VISIBILITY\r\n    ).length;\r\n    \r\n    // ‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ‡∏à‡∏∏‡∏î‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏°‡∏≠‡∏á‡πÄ‡∏´‡πá‡∏ô‡πÑ‡∏î‡πâ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 4 ‡∏à‡∏∏‡∏î‡∏à‡∏≤‡∏Å 6 ‡∏à‡∏∏‡∏î\r\n    return visibleCriticalPoints >= 4;\r\n  }\r\n\r\n  /**\r\n   * üëÅÔ∏è ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏à‡∏∏‡∏î‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏°‡∏≠‡∏á‡πÄ‡∏´‡πá‡∏ô‡πÑ‡∏î‡πâ\r\n   */\r\n  arePointsVisible(points) {\r\n    return points.every(point => \r\n      point && \r\n      typeof point.visibility === 'number' && \r\n      point.visibility > this.MIN_VISIBILITY\r\n    );\r\n  }\r\n\r\n  /**\r\n   * ‚ùå ‡∏™‡∏£‡πâ‡∏≤‡∏á error result\r\n   */\r\n  getErrorResult(message) {\r\n    return {\r\n      accuracy: 0,\r\n      confidence: 0,\r\n      feedback: message,\r\n      jointComparisons: {},\r\n      trainerDirection: 'UNKNOWN',\r\n      traineeDirection: 'UNKNOWN',\r\n      bodyPartScores: {},\r\n      recommendations: []\r\n    };\r\n  }\r\n\r\n  /**\r\n   * üé® ‡∏™‡∏µ accuracy ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö UI\r\n   */\r\n  getAccuracyColor(accuracy) {\r\n    if (accuracy >= 85) return '#22c55e'; // Green\r\n    if (accuracy >= 70) return '#eab308'; // Yellow\r\n    if (accuracy >= 50) return '#f97316'; // Orange\r\n    return '#ef4444'; // Red\r\n  }\r\n}\r\n\r\n// Export singleton instance\r\nexport const multiDirectionalPoseComparator = new MultiDirectionalPoseComparator();\r\nexport default MultiDirectionalPoseComparator;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}